"use strict";const e=require("../../common/vendor.js"),t=require("../../stores/user.js");Math||(a+o+n)();const a=()=>"../../components/brutalist/BrutalistCard.js",n=()=>"../../components/brutalist/BrutalistButton.js",o=()=>"../../components/brutalist/BrutalistInput.js",i=e.defineComponent({__name:"create",setup(a){const n=t.useUserStore(),o=e.ref({title:"",description:"",tags:[],amount:5}),i=["å–å¿«é€’","ä¹°é¥­","æ‰“å°","ä»£è´­","é€ä¸œè¥¿","å…¶ä»–"],s=[3,5,8,10,15],u=e.ref(""),l=e.computed((()=>!s.includes(o.value.amount)));function c(e){return{"å–å¿«é€’":"ðŸ“¦","ä¹°é¥­":"ðŸœ","æ‰“å°":"ðŸ“„","ä»£è´­":"ðŸ›’","é€ä¸œè¥¿":"ðŸšš","å…¶ä»–":"ðŸ“Œ"}[e]||"ðŸ·ï¸"}function r(){o.value.amount=0,u.value=""}function d(e){const t=parseFloat(e.detail.value);t>0&&(o.value.amount=t)}function v(){e.index.navigateBack()}async function m(){var t,a,i,s;if(n.isLoggedIn)if(o.value.title.trim())if(0!==o.value.tags.length)if(o.value.description.trim())if(o.value.amount<=0)e.index.showToast({title:"è¯·è¾“å…¥è·‘è…¿è´¹",icon:"none"});else{e.index.showLoading({title:"å‘å¸ƒä¸­..."});try{const i=e.tr.database();await i.collection("requests").add({type:"delivery",title:o.value.title,description:o.value.description,tags:o.value.tags,amount:o.value.amount,creator:(null==(t=n.user)?void 0:t._id)||"user_"+Date.now(),creatorName:(null==(a=n.user)?void 0:a.nickname)||"æ ¡å›­ç”¨æˆ·",status:"open"}),e.index.hideLoading(),e.index.showToast({title:"å‘å¸ƒæˆåŠŸï¼",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),1500)}catch(u){e.index.hideLoading(),e.index.__f__("error","at pages/delivery/create.vue:277","å‘å¸ƒå¤±è´¥:",u);const t={_id:"req_"+Date.now(),title:o.value.title,description:o.value.description,tags:o.value.tags,amount:o.value.amount,creator:(null==(i=n.user)?void 0:i._id)||"user_"+Date.now(),creatorName:(null==(s=n.user)?void 0:s.nickname)||"æ ¡å›­ç”¨æˆ·",createTime:Date.now(),status:"open"},a=e.index.getStorageSync("mock_requests")||[];a.unshift(t),e.index.setStorageSync("mock_requests",a),e.index.showToast({title:"å‘å¸ƒæˆåŠŸï¼ˆæœ¬åœ°ï¼‰",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),1500)}}else e.index.showToast({title:"è¯·è¾“å…¥æè¿°",icon:"none"});else e.index.showToast({title:"è¯·é€‰æ‹©ä»»åŠ¡ç±»åž‹",icon:"none"});else e.index.showToast({title:"è¯·è¾“å…¥æ ‡é¢˜",icon:"none"});else e.index.showToast({title:"è¯·å…ˆç™»å½•",icon:"none"})}return(t,a)=>e.e({a:e.o(v),b:e.p({taped:!0,accent:!0}),c:e.o((e=>o.value.title=e)),d:e.p({placeholder:"ä¾‹å¦‚ï¼šå¸®å¿™å–ä¸ªå¿«é€’",maxlength:30,"show-count":!0,taped:!0,modelValue:o.value.title}),e:e.f(i,((t,a,n)=>({a:e.t(c(t)),b:e.t(t),c:t,d:o.value.tags.includes(t)?1:"",e:e.o((e=>function(e){const t=o.value.tags.indexOf(e);o.value.tags=-1===t?[e]:[]}(t)),t)}))),f:o.value.description,g:e.o((e=>o.value.description=e.detail.value)),h:e.t(o.value.description.length),i:e.f(s,((t,a,n)=>({a:e.t(t),b:t,c:o.value.amount===t?1:"",d:e.o((e=>function(e){o.value.amount=e,u.value=""}(t)),t)}))),j:!l.value},l.value?{k:e.o([e=>u.value=e.detail.value,d]),l:u.value}:{},{m:l.value?1:"",n:e.o(r),o:e.o(m),p:e.p({accent:!0,taped:!0,arrow:!0,large:!0})})}}),s=e._export_sfc(i,[["__scopeId","data-v-27983192"]]);wx.createPage(s);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/delivery/create.js.map
