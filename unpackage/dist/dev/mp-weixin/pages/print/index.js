"use strict";const e=require("../../common/vendor.js"),t=require("../../stores/user.js");Math||(o+n)();const n=()=>"../../components/brutalist/BrutalistCard.js",o=()=>"../../components/brutalist/BrutalistButton.js",i=e.defineComponent({__name:"index",setup(n){const o=t.useUserStore(),i=e.ref([]),a=e.ref(null),l=["全部打印店","图书馆一楼打印店","学生活动中心B座打印点","东门校外打印店（5分钟）","西门快印中心"],r=e.computed((()=>null===a.value||0===a.value?i.value:i.value.filter((e=>e.shopName===l[a.value]))));function u(e){a.value=e.detail.value}function s(e){const t=new Date(e),n=(new Date).getTime()-t.getTime();return n<6e4?"刚刚":n<36e5?Math.floor(n/6e4)+"分钟前":n<864e5?Math.floor(n/36e5)+"小时前":Math.floor(n/864e5)+"天前"}function d(){o.isLoggedIn?e.index.navigateTo({url:"/pages/print/create"}):e.index.showToast({title:"请先登录",icon:"none"})}function c(e){return{"mono-single":"黑白单面","mono-double":"黑白双面","color-single":"彩色单面","color-double":"彩色双面"}[e]||e}function p(e){var t,n;const o=(null==(t=null==e?void 0:e.option)?void 0:t.startsWith("color"))?.8:.3,i=(null==(n=null==e?void 0:e.option)?void 0:n.endsWith("double"))?.9:1;return parseFloat((o*((null==e?void 0:e.copies)||1)*i).toFixed(2))}return e.onMounted((()=>{!async function(){try{const t=e.tr.database(),n=(await t.collection("requests").where({type:"print"}).orderBy("createTime","desc").get()).data;i.value=n.map((e=>{var t,n,o,i;return{_id:e._id,title:e.title,shopName:(null==(t=e.print)?void 0:t.shop)||"",option:c(null==(n=e.print)?void 0:n.option),copies:(null==(o=e.print)?void 0:o.copies)||1,amount:p(e.print),status:e.status,createTime:e.createTime,fileId:(null==(i=e.print)?void 0:i.fileId)||""}}))}catch(t){e.index.__f__("error","at pages/print/index.vue:183","加载失败:",t),e.index.showToast({title:"加载失败",icon:"none"})}}()})),(t,n)=>e.e({a:e.o(d),b:e.p({accent:!0}),c:e.t(null!==a.value?l[a.value]:"全部打印店"),d:l,e:a.value,f:e.o(u),g:e.f(r.value,((t,n,o)=>{return{a:e.t(t.title),b:e.t((i=t.status,{pending:"待支付",paid:"待打印",printing:"打印中",completed:"已完成",cancelled:"已取消"}[i]||i)),c:e.n("status-"+t.status),d:e.t(t.shopName),e:e.t(t.option),f:e.t(t.copies),g:e.t(s(t.createTime)),h:e.t(t.amount),i:t._id,j:e.o((n=>function(t){e.index.navigateTo({url:`/pages/print/detail?id=${t._id}`})}(t)),t._id),k:"17bf6d03-2-"+o};var i})),h:0===r.value.length},(r.value.length,{}))}}),a=e._export_sfc(i,[["__scopeId","data-v-17bf6d03"]]);wx.createPage(a);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/print/index.js.map
