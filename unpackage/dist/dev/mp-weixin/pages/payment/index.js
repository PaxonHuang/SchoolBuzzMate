"use strict";const e=require("../../common/vendor.js");Math||t();const t=()=>"../../components/brutalist/BrutalistCard.js",a=e.defineComponent({__name:"index",setup(t){const a=e.ref(""),n=e.ref(0);e.onLoad((e=>{a.value=e.orderId,n.value=parseFloat(e.amount)}));const o=async()=>{try{const t=await e.tr.callFunction({name:"createPayment",data:{orderId:a.value}});if(200!==t.result.code)return void e.index.showToast({title:t.result.message||"支付参数获取失败",icon:"none"});const{paymentParams:n}=t.result.data;await e.index.requestPayment({...n,success:async()=>{await e.tr.database().collection("orders").doc(a.value).update({status:"paid",paymentTime:Date.now()}),e.index.showToast({title:"支付成功"}),setTimeout((()=>{e.index.navigateBack()}),1500)},fail:t=>{e.index.__f__("error","at pages/payment/index.vue:70","支付失败:",t),e.index.showToast({title:"支付取消或失败",icon:"none"})}})}catch(t){e.index.__f__("error","at pages/payment/index.vue:78","支付处理失败:",t),e.index.showToast({title:"支付处理失败",icon:"none"})}};return(t,a)=>({a:e.t(n.value),b:e.o(o),c:e.p({accent:!0})})}}),n=e._export_sfc(a,[["__scopeId","data-v-7695f594"]]);wx.createPage(n);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/payment/index.js.map
