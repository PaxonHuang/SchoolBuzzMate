"use strict";const e=require("../../common/vendor.js"),t=require("../../stores/user.js");Math||(a+n+o)();const a=()=>"../../components/brutalist/BrutalistCard.js",o=()=>"../../components/brutalist/BrutalistButton.js",n=()=>"../../components/brutalist/BrutalistInput.js",i=e.defineComponent({__name:"create",setup(a){const o=t.useUserStore(),n=e.ref({title:"",content:"",category:"study",images:[]}),i=[{label:"å­¦ä¹ äº¤æµ",value:"study",emoji:"ðŸ“š"},{label:"æ ¡å›­ç”Ÿæ´»",value:"life",emoji:"ðŸŒŸ"},{label:"å¤±ç‰©æ‹›é¢†",value:"lost",emoji:"ðŸ”"},{label:"äºŒæ‰‹äº¤æ˜“",value:"trade",emoji:"ðŸ’°"},{label:"æ´»åŠ¨èšä¼š",value:"event",emoji:"ðŸŽ‰"}];function l(){e.index.chooseImage({count:9-n.value.images.length,success:e=>{n.value.images.push(...e.tempFilePaths)}})}function s(){e.index.navigateBack()}async function u(){var t,a,l,s;if(o.isLoggedIn)if(n.value.title.trim())if(n.value.title.trim().length<5)e.index.showToast({title:"æ ‡é¢˜è‡³å°‘5ä¸ªå­—",icon:"none"});else if(n.value.content.trim())if(n.value.content.trim().length<10)e.index.showToast({title:"å†…å®¹è‡³å°‘10ä¸ªå­—",icon:"none"});else{e.index.showLoading({title:"å‘å¸ƒä¸­..."});try{const l=e.tr.database(),s=i.find((e=>e.value===n.value.category)),u=(null==s?void 0:s.label)||"å­¦ä¹ äº¤æµ";await l.collection("posts").add({type:"post",title:n.value.title,content:n.value.content,category:n.value.category,categoryName:u,images:n.value.images,creatorName:(null==(t=o.user)?void 0:t.nickname)||"æ ¡å›­ç”¨æˆ·",creatorAvatar:(null==(a=o.user)?void 0:a.avatar)||"",createTime:Date.now(),viewCount:0,commentCount:0,likeCount:0,status:"published"}),e.index.hideLoading(),e.index.showToast({title:"å‘å¸ƒæˆåŠŸï¼",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),1500)}catch(u){e.index.hideLoading(),e.index.__f__("error","at pages/forum/create.vue:255","å‘å¸ƒå¤±è´¥:",u);const t={_id:"post_"+Date.now(),title:n.value.title,content:n.value.content,category:n.value.category,categoryName:(null==(l=i.find((e=>e.value===n.value.category)))?void 0:l.label)||"å­¦ä¹ äº¤æµ",images:n.value.images,creatorName:(null==(s=o.user)?void 0:s.nickname)||"æ ¡å›­ç”¨æˆ·",creatorAvatar:"",createTime:Date.now(),viewCount:0,commentCount:0,likeCount:0},a=e.index.getStorageSync("mock_posts")||[];a.unshift(t),e.index.setStorageSync("mock_posts",a),e.index.showToast({title:"å‘å¸ƒæˆåŠŸï¼ˆæœ¬åœ°ï¼‰",icon:"success"}),setTimeout((()=>{e.index.navigateBack()}),1500)}}else e.index.showToast({title:"è¯·è¾“å…¥å†…å®¹",icon:"none"});else e.index.showToast({title:"è¯·è¾“å…¥æ ‡é¢˜",icon:"none"});else e.index.showToast({title:"è¯·å…ˆç™»å½•",icon:"none"})}return(t,a)=>e.e({a:e.o(s),b:e.p({taped:!0,accent:!0}),c:e.o((e=>n.value.title=e)),d:e.p({placeholder:"è¯·è¾“å…¥æ ‡é¢˜ï¼ˆ5-50å­—ï¼‰",maxlength:50,"show-count":!0,taped:!0,modelValue:n.value.title}),e:e.f(i,((t,a,o)=>({a:e.t(t.emoji),b:e.t(t.label),c:t.value,d:n.value.category===t.value?1:"",e:e.o((e=>{return a=t.value,void(n.value.category=a);var a}),t.value)}))),f:n.value.content,g:e.o((e=>n.value.content=e.detail.value)),h:e.t(n.value.content.length),i:e.f(n.value.images,((t,a,o)=>({a:t,b:e.o((e=>function(e){n.value.images.splice(e,1)}(a)),a),c:a}))),j:n.value.images.length<9},n.value.images.length<9?{k:e.o(l)}:{},{l:e.o(u),m:e.p({accent:!0,taped:!0,arrow:!0,large:!0})})}}),l=e._export_sfc(i,[["__scopeId","data-v-ee120cef"]]);wx.createPage(l);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/forum/create.js.map
