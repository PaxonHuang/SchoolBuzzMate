{"version":3,"file":"create.js","sources":["pages/delivery/create.vue","../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZGVsaXZlcnkvY3JlYXRlLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"page-container\">\n    <!-- È°µÈù¢ËÉåÊôØË£ÖÈ•∞ -->\n    <view class=\"page-doodle-1\">‚ú¶</view>\n\n    <!-- ËøîÂõûÂØºËà™ -->\n    <view class=\"nav-back\" @click=\"goBack\">\n      <text class=\"back-icon\">‚Üê</text>\n      <text class=\"back-text\">ËøîÂõû</text>\n    </view>\n\n    <!-- Ê†áÈ¢òÂç°Áâá -->\n    <brutalist-card class=\"header-card\" taped accent>\n      <text class=\"header-title\">ÂèëÂ∏ÉË∑ëËÖø</text>\n      <text class=\"header-subtitle\">‰∫íÂä©‰æøÂà©ÔºåËΩªÊùæÊêûÂÆö</text>\n    </brutalist-card>\n\n    <!-- Ë°®ÂçïÂç°Áâá -->\n    <brutalist-card class=\"form-card\">\n      <!-- Ê†áÈ¢òËæìÂÖ• -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>üìù</text>\n          <text>‰ªªÂä°Ê†áÈ¢ò</text>\n          <text class=\"required\">*</text>\n        </text>\n        <brutalist-input\n          v-model=\"formData.title\"\n          placeholder=\"‰æãÂ¶ÇÔºöÂ∏ÆÂøôÂèñ‰∏™Âø´ÈÄí\"\n          :maxlength=\"30\"\n          show-count\n          taped\n        />\n      </view>\n\n      <!-- ‰ªªÂä°Á±ªÂûã -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>üè∑Ô∏è</text>\n          <text>‰ªªÂä°Á±ªÂûã</text>\n          <text class=\"required\">*</text>\n        </text>\n        <view class=\"tag-grid\">\n          <view\n            v-for=\"tag in deliveryTags\"\n            :key=\"tag\"\n            class=\"tag-item\"\n            :class=\"{ 'active': formData.tags.includes(tag) }\"\n            @click=\"toggleTag(tag)\"\n          >\n            <text>{{ getTagEmoji(tag) }}</text>\n            <text>{{ tag }}</text>\n          </view>\n        </view>\n      </view>\n\n      <!-- ËØ¶ÁªÜÊèèËø∞ -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>‚úçÔ∏è</text>\n          <text>ËØ¶ÁªÜÊèèËø∞</text>\n          <text class=\"required\">*</text>\n        </text>\n        <view class=\"textarea-wrapper\">\n          <textarea\n            v-model=\"formData.description\"\n            class=\"form-textarea\"\n            placeholder=\"ËØ∑ËØ¶ÁªÜÊèèËø∞‰Ω†ÁöÑÈúÄÊ±ÇÔºåÂåÖÊã¨Âèñ‰ª∂Âú∞ÁÇπ„ÄÅÈÄÅËææÂú∞ÁÇπÁ≠â...\"\n            :maxlength=\"300\"\n          />\n          <text class=\"char-count\">{{ formData.description.length }}/300</text>\n        </view>\n      </view>\n\n      <!-- Ë∑ëËÖøË¥π -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>üí∞</text>\n          <text>Ë∑ëËÖøË¥π</text>\n          <text class=\"required\">*</text>\n        </text>\n        <view class=\"amount-selector\">\n          <view\n            v-for=\"amount in presetAmounts\"\n            :key=\"amount\"\n            class=\"amount-item\"\n            :class=\"{ 'active': formData.amount === amount }\"\n            @click=\"selectAmount(amount)\"\n          >\n            <text>¬•{{ amount }}</text>\n          </view>\n          <view\n            class=\"amount-item custom\"\n            :class=\"{ 'active': isCustomAmount }\"\n            @click=\"showCustomInput\"\n          >\n            <text v-if=\"!isCustomAmount\">Ëá™ÂÆö‰πâ</text>\n            <input\n              v-else\n              v-model=\"customAmount\"\n              class=\"custom-input\"\n              type=\"digit\"\n              placeholder=\"ÈáëÈ¢ù\"\n              @input=\"onCustomAmountInput\"\n            />\n          </view>\n        </view>\n      </view>\n\n      <!-- Êèê‰∫§ÊåâÈíÆ -->\n      <brutalist-button\n        class=\"submit-btn\"\n        accent\n        taped\n        arrow\n        large\n        @click=\"submitRequest\"\n      >\n        ÂèëÂ∏ÉÈúÄÊ±Ç\n      </brutalist-button>\n    </brutalist-card>\n\n    <!-- ÊèêÁ§∫ -->\n    <view class=\"tips\">\n      <text class=\"tips-text\">üí° ËØ∑Á°Æ‰øù‰ø°ÊÅØÂáÜÁ°ÆÔºåÊé•ÂçïÂêé‰ºöÂ∞ΩÂø´ËÅîÁ≥ªÊÇ®</text>\n    </view>\n  </view>\n</template>\n\n<script setup lang=\"uts\">\nimport { ref, computed } from 'vue'\nimport { useUserStore } from '@/stores/user'\nimport BrutalistCard from '@/components/brutalist/BrutalistCard.vue'\nimport BrutalistButton from '@/components/brutalist/BrutalistButton.vue'\nimport BrutalistInput from '@/components/brutalist/BrutalistInput.vue'\n\ninterface FormData {\n  title: string\n  description: string\n  tags: string[]\n  amount: number\n}\n\nconst userStore = useUserStore()\nconst formData = ref<FormData>({\n  title: '',\n  description: '',\n  tags: [],\n  amount: 5\n})\n\nconst deliveryTags = [\n  'ÂèñÂø´ÈÄí', '‰π∞È•≠', 'ÊâìÂç∞', '‰ª£Ë¥≠', 'ÈÄÅ‰∏úË•ø', 'ÂÖ∂‰ªñ'\n]\n\nconst presetAmounts = [3, 5, 8, 10, 15]\nconst customAmount = ref('')\nconst isCustomAmount = computed(() => {\n  return !presetAmounts.includes(formData.value.amount)\n})\n\nfunction getTagEmoji(tag: string): string {\n  const emojiMap: Record<string, string> = {\n    'ÂèñÂø´ÈÄí': 'üì¶',\n    '‰π∞È•≠': 'üçú',\n    'ÊâìÂç∞': 'üìÑ',\n    '‰ª£Ë¥≠': 'üõí',\n    'ÈÄÅ‰∏úË•ø': 'üöö',\n    'ÂÖ∂‰ªñ': 'üìå'\n  }\n  return emojiMap[tag] || 'üè∑Ô∏è'\n}\n\nfunction toggleTag(tag: string) {\n  const index = formData.value.tags.indexOf(tag)\n  if (index === -1) {\n    formData.value.tags = [tag] // ÂçïÈÄâ\n  } else {\n    formData.value.tags = []\n  }\n}\n\nfunction selectAmount(amount: number) {\n  formData.value.amount = amount\n  customAmount.value = ''\n}\n\nfunction showCustomInput() {\n  formData.value.amount = 0\n  customAmount.value = ''\n}\n\nfunction onCustomAmountInput(e: any) {\n  const val = parseFloat(e.detail.value)\n  if (val > 0) {\n    formData.value.amount = val\n  }\n}\n\nfunction goBack() {\n  uni.navigateBack()\n}\n\nasync function submitRequest() {\n  // Ê£ÄÊü•ÁôªÂΩï\n  if (!userStore.isLoggedIn) {\n    uni.showToast({\n      title: 'ËØ∑ÂÖàÁôªÂΩï',\n      icon: 'none'\n    })\n    return\n  }\n\n  // È™åËØÅÊ†áÈ¢ò\n  if (!formData.value.title.trim()) {\n    uni.showToast({\n      title: 'ËØ∑ËæìÂÖ•Ê†áÈ¢ò',\n      icon: 'none'\n    })\n    return\n  }\n\n  // È™åËØÅÁ±ªÂûã\n  if (formData.value.tags.length === 0) {\n    uni.showToast({\n      title: 'ËØ∑ÈÄâÊã©‰ªªÂä°Á±ªÂûã',\n      icon: 'none'\n    })\n    return\n  }\n\n  // È™åËØÅÊèèËø∞\n  if (!formData.value.description.trim()) {\n    uni.showToast({\n      title: 'ËØ∑ËæìÂÖ•ÊèèËø∞',\n      icon: 'none'\n    })\n    return\n  }\n\n  // È™åËØÅÈáëÈ¢ù\n  if (formData.value.amount <= 0) {\n    uni.showToast({\n      title: 'ËØ∑ËæìÂÖ•Ë∑ëËÖøË¥π',\n      icon: 'none'\n    })\n    return\n  }\n\n  uni.showLoading({ title: 'ÂèëÂ∏É‰∏≠...' })\n\n  try {\n    const db = uniCloud.database()\n\n    await db.collection('requests').add({\n      type: 'delivery',\n      title: formData.value.title,\n      description: formData.value.description,\n      tags: formData.value.tags,\n      amount: formData.value.amount,\n      creator: userStore.user?._id || 'user_' + Date.now(),\n      creatorName: userStore.user?.nickname || 'Ê†°Âõ≠Áî®Êà∑',\n      status: 'open'\n    })\n\n    uni.hideLoading()\n    uni.showToast({\n      title: 'ÂèëÂ∏ÉÊàêÂäüÔºÅ',\n      icon: 'success'\n    })\n\n    setTimeout(() => {\n      uni.navigateBack()\n    }, 1500)\n  } catch (e) {\n    uni.hideLoading()\n    uni.__f__('error','at pages/delivery/create.vue:277','ÂèëÂ∏ÉÂ§±Ë¥•:', e)\n\n    // ÈôçÁ∫ßÂ§ÑÁêÜÔºö‰ΩøÁî®Êú¨Âú∞Â≠òÂÇ®Ê®°Êãü\n    const mockRequest = {\n      _id: 'req_' + Date.now(),\n      title: formData.value.title,\n      description: formData.value.description,\n      tags: formData.value.tags,\n      amount: formData.value.amount,\n      creator: userStore.user?._id || 'user_' + Date.now(),\n      creatorName: userStore.user?.nickname || 'Ê†°Âõ≠Áî®Êà∑',\n      createTime: Date.now(),\n      status: 'open'\n    }\n\n    // ‰øùÂ≠òÂà∞Êú¨Âú∞\n    const requests = uni.getStorageSync('mock_requests') || []\n    requests.unshift(mockRequest)\n    uni.setStorageSync('mock_requests', requests)\n\n    uni.showToast({\n      title: 'ÂèëÂ∏ÉÊàêÂäüÔºàÊú¨Âú∞Ôºâ',\n      icon: 'success'\n    })\n\n    setTimeout(() => {\n      uni.navigateBack()\n    }, 1500)\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n// ÈáéÂÖΩÊ¥æÈÖçËâ≤ÊñπÊ°à\n$black: #000000;\n$white: #ffffff;\n$red: #FF6B6B;\n$teal: #4ECDC4;\n$yellow: #FFE66D;\n\n.page-container {\n  min-height: 100vh;\n  padding: 24rpx;\n  padding-bottom: 48rpx;\n  background: linear-gradient(180deg, #FFF9E6 0%, #ffffff 50%, #FFE6F0 100%);\n  position: relative;\n}\n\n// ËÉåÊôØÊ∂ÇÈ∏¶\n.page-doodle-1 {\n  position: fixed;\n  top: 100rpx;\n  right: 30rpx;\n  font-size: 40rpx;\n  color: $red;\n  opacity: 0.3;\n  animation: spin 10s linear infinite;\n  z-index: 0;\n}\n\n// ËøîÂõûÂØºËà™\n.nav-back {\n  display: flex;\n  align-items: center;\n  margin-bottom: 24rpx;\n  padding: 12rpx 0;\n\n  .back-icon {\n    font-size: 36rpx;\n    font-weight: 900;\n    margin-right: 8rpx;\n  }\n\n  .back-text {\n    font-size: 26rpx;\n    font-weight: 700;\n  }\n}\n\n// Ê†áÈ¢òÂç°Áâá\n.header-card {\n  text-align: center;\n  padding: 32rpx 24rpx !important;\n  margin-bottom: 24rpx !important;\n\n  .header-title {\n    display: block;\n    font-size: 40rpx;\n    font-weight: 900;\n    color: $black;\n    margin-bottom: 8rpx;\n  }\n\n  .header-subtitle {\n    display: block;\n    font-size: 24rpx;\n    color: #666;\n  }\n}\n\n// Ë°®ÂçïÂç°Áâá\n.form-card {\n  padding: 32rpx 24rpx !important;\n}\n\n.form-group {\n  margin-bottom: 32rpx;\n\n  .form-label {\n    display: flex;\n    align-items: center;\n    gap: 8rpx;\n    margin-bottom: 12rpx;\n    font-size: 26rpx;\n    font-weight: 900;\n\n    text:first-child {\n      font-size: 28rpx;\n    }\n\n    .required {\n      color: $red;\n    }\n  }\n}\n\n// Ê†áÁ≠æÁΩëÊ†º\n.tag-grid {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 12rpx;\n}\n\n.tag-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 6rpx;\n  padding: 16rpx 12rpx;\n  border: 3rpx solid $black;\n  background: $white;\n  box-shadow: 3rpx 3rpx 0 $black;\n  transition: all 0.2s ease;\n\n  text:first-child {\n    font-size: 32rpx;\n  }\n\n  text:last-child {\n    font-size: 22rpx;\n    font-weight: 700;\n  }\n\n  &.active {\n    background: $yellow;\n    transform: translate(-2rpx, -2rpx);\n    box-shadow: 5rpx 5rpx 0 $black;\n  }\n\n  &:active {\n    transform: translate(2rpx, 2rpx);\n    box-shadow: 1rpx 1rpx 0 $black;\n  }\n}\n\n// ÊñáÊú¨Âüü\n.textarea-wrapper {\n  position: relative;\n\n  .form-textarea {\n    width: 100%;\n    min-height: 200rpx;\n    padding: 20rpx;\n    border: 4rpx solid $black;\n    background: $white;\n    font-size: 28rpx;\n    line-height: 1.6;\n    box-shadow: 4rpx 4rpx 0 $black;\n\n    clip-path: polygon(\n      1% 0%, 98% 1%, 99% 98%, 1% 100%\n    );\n  }\n\n  .char-count {\n    position: absolute;\n    bottom: 16rpx;\n    right: 16rpx;\n    font-size: 22rpx;\n    color: #999;\n  }\n}\n\n// ÈáëÈ¢ùÈÄâÊã©\n.amount-selector {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 12rpx;\n}\n\n.amount-item {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 100rpx;\n  padding: 16rpx 24rpx;\n  border: 3rpx solid $black;\n  background: $white;\n  box-shadow: 3rpx 3rpx 0 $black;\n  font-size: 28rpx;\n  font-weight: 700;\n  transition: all 0.2s ease;\n\n  &.active {\n    background: $red;\n    color: $white;\n    transform: translate(-2rpx, -2rpx);\n    box-shadow: 5rpx 5rpx 0 $black;\n  }\n\n  &:active {\n    transform: translate(2rpx, 2rpx);\n    box-shadow: 1rpx 1rpx 0 $black;\n  }\n\n  &.custom {\n    .custom-input {\n      width: 80rpx;\n      text-align: center;\n      font-size: 28rpx;\n      font-weight: 700;\n    }\n  }\n}\n\n.submit-btn {\n  width: 100%;\n  margin-top: 24rpx;\n}\n\n// ÊèêÁ§∫\n.tips {\n  text-align: center;\n  padding: 24rpx;\n\n  .tips-text {\n    font-size: 24rpx;\n    color: #999;\n  }\n}\n\n// Âä®Áîª\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n</style>\n","import MiniProgramPage from 'E:/codeplace/test/pages/delivery/create.vue'\nwx.createPage(MiniProgramPage)"],"names":["BrutalistCard","BrutalistButton","BrutalistInput","userStore","useUserStore","formData","ref","title","description","tags","amount","deliveryTags","presetAmounts","customAmount","isCustomAmount","computed","includes","value","getTagEmoji","tag","showCustomInput","onCustomAmountInput","e","val","parseFloat","detail","goBack","uni","index","navigateBack","async","submitRequest","isLoggedIn","trim","length","showToast","icon","showLoading","db","uniCloud","database","collection","add","type","creator","_a","user","_id","Date","now","creatorName","_b","nickname","status","hideLoading","setTimeout","__f__","mockRequest","_c","_d","createTime","requests","getStorageSync","unshift","setStorageSync","indexOf","wx","createPage","MiniProgramPage"],"mappings":"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"}