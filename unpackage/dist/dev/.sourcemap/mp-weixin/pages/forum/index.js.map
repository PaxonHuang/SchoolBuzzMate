{"version":3,"file":"index.js","sources":["pages/forum/index.vue","../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZm9ydW0vaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view class=\"page-container\">\n    <!-- È°µÈù¢ËÉåÊôØË£ÖÈ•∞ -->\n    <view class=\"page-doodle-1\">‚ú¶</view>\n    <view class=\"page-doodle-2\">‚óâ</view>\n\n    <!-- È°µÈù¢Ê†áÈ¢òÂç°Áâá -->\n    <brutalist-card class=\"page-header\" taped accent>\n      <text class=\"page-title\">Ê†°Âõ≠ËÆ∫Âùõ</text>\n      <text class=\"page-subtitle\">ÂàÜ‰∫´‰Ω†ÁöÑÊ†°Âõ≠ÁîüÊ¥ª</text>\n    </brutalist-card>\n\n    <!-- È°∂ÈÉ®Êìç‰ΩúÊ†è -->\n    <view class=\"header-actions\">\n      <brutalist-button class=\"create-btn\" accent taped arrow @click=\"navigateToCreate\">\n        + ÂèëÂ∏ÉÂ∏ñÂ≠ê\n      </brutalist-button>\n    </view>\n\n    <!-- ÂàÜÁ±ªÁ≠õÈÄâÊ†áÁ≠æ -->\n    <view class=\"category-tabs\">\n      <view\n        v-for=\"category in categories\"\n        :key=\"category.value\"\n        class=\"category-tag\"\n        :class=\"{ 'active': currentCategory === category.value }\"\n        @click=\"changeCategory(category.value)\"\n      >\n        <text class=\"tag-emoji\">{{ category.emoji }}</text>\n        <text class=\"tag-label\">{{ category.label }}</text>\n      </view>\n    </view>\n\n    <!-- Â∏ñÂ≠êÂàóË°® -->\n    <view class=\"post-list\">\n      <view\n        v-for=\"post in filteredPosts\"\n        :key=\"post._id\"\n        class=\"post-card-wrapper\"\n        @click=\"viewDetail(post)\"\n      >\n        <brutalist-card class=\"post-card\" :class=\"{ 'taped': post.pinned }\">\n          <!-- Â∏ñÂ≠êÂ§¥ÈÉ® -->\n          <view class=\"post-header\">\n            <view class=\"avatar-wrapper\">\n              <text class=\"avatar-text\">{{ post.creatorName?.charAt(0) || 'U' }}</text>\n            </view>\n            <view class=\"user-info\">\n              <text class=\"username\">{{ post.creatorName }}</text>\n              <text class=\"time\">{{ formatTime(post.createTime) }}</text>\n            </view>\n            <view v-if=\"post.pinned\" class=\"pinned-badge\">\n              <text>üìå</text>\n            </view>\n          </view>\n\n          <!-- Â∏ñÂ≠êÊ†áÈ¢ò -->\n          <text class=\"post-title\">{{ post.title }}</text>\n\n          <!-- Â∏ñÂ≠êÂÜÖÂÆπ -->\n          <text class=\"post-content\">{{ post.content }}</text>\n\n          <!-- Â∏ñÂ≠êÂõæÁâá -->\n          <view v-if=\"post.images && post.images.length > 0\" class=\"post-images\">\n            <view\n              v-for=\"(img, index) in post.images.slice(0, 3)\"\n              :key=\"index\"\n              class=\"image-wrapper\"\n            >\n              <image class=\"post-image\" :src=\"img\" mode=\"aspectFill\" />\n            </view>\n            <view v-if=\"post.images.length > 3\" class=\"more-images\">\n              <text>+{{ post.images.length - 3 }}</text>\n            </view>\n          </view>\n\n          <!-- Â∏ñÂ≠êÂ∫ïÈÉ®‰ø°ÊÅØ -->\n          <view class=\"post-footer\">\n            <view class=\"stats\">\n              <view class=\"stat-item\">\n                <text>üëÅ</text>\n                <text>{{ post.viewCount || 0 }}</text>\n              </view>\n              <view class=\"stat-item\">\n                <text>üí¨</text>\n                <text>{{ post.commentCount || 0 }}</text>\n              </view>\n              <view class=\"stat-item\">\n                <text>üëç</text>\n                <text>{{ post.likeCount || 0 }}</text>\n              </view>\n            </view>\n            <view class=\"category-badge\">\n              <text>{{ post.categoryName }}</text>\n            </view>\n          </view>\n        </brutalist-card>\n      </view>\n    </view>\n\n    <!-- Á©∫Áä∂ÊÄÅ -->\n    <view v-if=\"filteredPosts.length === 0\" class=\"empty-state\">\n      <brutalist-card class=\"empty-card\" dashed>\n        <text class=\"empty-icon\">üì≠</text>\n        <text class=\"empty-text\">ÊöÇÊó†Áõ∏ÂÖ≥Â∏ñÂ≠ê</text>\n        <text class=\"empty-hint\">Âø´Êù•ÂèëÂ∏ÉÁ¨¨‰∏ÄÊù°Â∏ñÂ≠êÂêßÔºÅ</text>\n      </brutalist-card>\n    </view>\n\n    <!-- Â∫ïÈÉ®ÂØºËà™Ê†è -->\n    <TabBar />\n  </view>\n</template>\n\n<script setup lang=\"uts\">\nimport { ref, computed, onMounted } from 'vue'\nimport { useUserStore } from '@/stores/user'\nimport BrutalistCard from '@/components/brutalist/BrutalistCard.vue'\nimport BrutalistButton from '@/components/brutalist/BrutalistButton.vue'\nimport TabBar from '@/components/brutalist/TabBar.vue'\n\ninterface Post {\n  _id: string\n  title: string\n  content: string\n  creatorName: string\n  creatorAvatar: string\n  categoryName: string\n  category: string\n  images: string[]\n  viewCount: number\n  commentCount: number\n  likeCount: number\n  createTime: number\n  pinned?: boolean\n}\n\nconst userStore = useUserStore()\nconst posts = ref<Post[]>([])\nconst currentCategory = ref<string>('all')\n\n// ÂàÜÁ±ªÈÄâÈ°πÔºàÂ∏¶emojiÔºâ\nconst categories = [\n  { label: 'ÂÖ®ÈÉ®', value: 'all', emoji: 'üì∞' },\n  { label: 'Â≠¶‰π†', value: 'study', emoji: 'üìö' },\n  { label: 'ÁîüÊ¥ª', value: 'life', emoji: 'üåü' },\n  { label: 'Â§±Áâ©', value: 'lost', emoji: 'üîç' },\n  { label: '‰∫§Êòì', value: 'trade', emoji: 'üí∞' },\n  { label: 'Ê¥ªÂä®', value: 'event', emoji: 'üéâ' }\n]\n\n// Á≠õÈÄâÂêéÁöÑÂ∏ñÂ≠ê\nconst filteredPosts = computed(() => {\n  if (currentCategory.value === 'all') {\n    return posts.value\n  }\n  return posts.value.filter(post => post.category === currentCategory.value)\n})\n\n// ÂàáÊç¢ÂàÜÁ±ª\nfunction changeCategory(category: string) {\n  currentCategory.value = category\n}\n\n// Ê†ºÂºèÂåñÊó∂Èó¥\nfunction formatTime(timestamp: number): string {\n  const date = new Date(timestamp)\n  const now = new Date()\n  const diff = now.getTime() - date.getTime()\n\n  if (diff < 60000) {\n    return 'ÂàöÂàö'\n  } else if (diff < 3600000) {\n    return Math.floor(diff / 60000) + 'ÂàÜÈíüÂâç'\n  } else if (diff < 86400000) {\n    return Math.floor(diff / 3600000) + 'Â∞èÊó∂Ââç'\n  } else {\n    return Math.floor(diff / 86400000) + 'Â§©Ââç'\n  }\n}\n\n// ÂØºËà™Âà∞ÂàõÂª∫È°µÈù¢\nfunction navigateToCreate() {\n  if (!userStore.isLoggedIn) {\n    uni.showToast({\n      title: 'ËØ∑ÂÖàÁôªÂΩï',\n      icon: 'none'\n    })\n    return\n  }\n\n  uni.navigateTo({\n    url: '/pages/forum/create'\n  })\n}\n\n// Êü•ÁúãËØ¶ÊÉÖ\nfunction viewDetail(post: Post) {\n  uni.navigateTo({\n    url: `/pages/forum/detail?id=${post._id}`\n  })\n}\n\n// Âä†ËΩΩÊï∞ÊçÆ\nasync function loadPosts() {\n  try {\n    const db = uniCloud.database()\n    const res = await db.collection('posts')\n      .orderBy('createTime', 'desc')\n      .limit(20)\n      .get()\n\n    posts.value = res.data as Post[]\n  } catch (e) {\n    uni.__f__('error','at pages/forum/index.vue:215','Âä†ËΩΩÂ§±Ë¥•:', e)\n    // ‰ΩøÁî®Ê®°ÊãüÊï∞ÊçÆ\n    posts.value = [\n      {\n        _id: '1',\n        title: 'Âõæ‰π¶È¶ÜÁ∫¶Â≠¶‰π†Êê≠Â≠ê',\n        content: 'ÊòéÂ§©‰∏ãÂçà2ÁÇπÔºåÂõæ‰π¶È¶Ü‰∏âÊ•ºÔºåÊúâÊ≤°Êúâ‰∏ÄËµ∑Â§ç‰π†È´òÊï∞ÁöÑÂêåÂ≠¶Ôºü',\n        creatorName: 'Â≠¶‰π†Ëææ‰∫∫',\n        creatorAvatar: '',\n        categoryName: 'Â≠¶‰π†‰∫§ÊµÅ',\n        category: 'study',\n        images: [],\n        viewCount: 128,\n        commentCount: 15,\n        likeCount: 32,\n        createTime: Date.now() - 3600000,\n        pinned: true\n      },\n      {\n        _id: '2',\n        title: 'È£üÂ†Ç‰∫åÊ•ºÊñ∞ÂºÄÁöÑÈ∫ªËæ£ÁÉ´Â•ΩËØÑÔºÅ',\n        content: '‰ªäÂ§©ËØï‰∫Ü‰∫åÊ•ºÊñ∞ÂºÄÁöÑÈ∫ªËæ£ÁÉ´ÔºåÂë≥ÈÅìÂæà‰∏çÈîôÔºåÊé®ËçêÂ§ßÂÆ∂ÂéªËØïËØï~',\n        creatorName: 'ÁæéÈ£üÊé¢Á¥¢ÂÆ∂',\n        creatorAvatar: '',\n        categoryName: 'Ê†°Âõ≠ÁîüÊ¥ª',\n        category: 'life',\n        images: [],\n        viewCount: 256,\n        commentCount: 42,\n        likeCount: 88,\n        createTime: Date.now() - 7200000\n      }\n    ] as Post[]\n  }\n}\n\nonMounted(() => {\n  loadPosts()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n// ÈáéÂÖΩÊ¥æÈÖçËâ≤ÊñπÊ°à\n$black: #000000;\n$white: #ffffff;\n$red: #FF6B6B;\n$teal: #4ECDC4;\n$yellow: #FFE66D;\n\n.page-container {\n  min-height: 100vh;\n  padding: 24rpx;\n  padding-bottom: 160rpx;\n  background: linear-gradient(180deg, #F0FFF4 0%, #ffffff 50%, #FFF9E6 100%);\n  position: relative;\n}\n\n// È°µÈù¢ËÉåÊôØÊ∂ÇÈ∏¶\n.page-doodle {\n  &-1 {\n    position: fixed;\n    top: 150rpx;\n    right: 30rpx;\n    font-size: 40rpx;\n    color: $yellow;\n    opacity: 0.35;\n    animation: spin 10s linear infinite;\n    z-index: 0;\n  }\n\n  &-2 {\n    position: fixed;\n    top: 400rpx;\n    left: 40rpx;\n    font-size: 36rpx;\n    color: $teal;\n    opacity: 0.3;\n    animation: pulse 2.5s ease-in-out infinite;\n    z-index: 0;\n  }\n}\n\n// È°µÈù¢Ê†áÈ¢òÂç°Áâá\n.page-header {\n  text-align: center;\n  padding: 32rpx 24rpx !important;\n  margin-bottom: 24rpx !important;\n\n  .page-title {\n    display: block;\n    font-size: 48rpx;\n    font-weight: 900;\n    color: $black;\n    margin-bottom: 8rpx;\n    letter-spacing: 2rpx;\n  }\n\n  .page-subtitle {\n    display: block;\n    font-size: 24rpx;\n    color: #666;\n  }\n}\n\n// È°∂ÈÉ®Êìç‰ΩúÊ†è\n.header-actions {\n  margin-bottom: 24rpx;\n\n  .create-btn {\n    width: 100%;\n  }\n}\n\n// ÂàÜÁ±ªÊ†áÁ≠æ\n.category-tabs {\n  display: flex;\n  gap: 12rpx;\n  margin-bottom: 32rpx;\n  overflow-x: auto;\n  padding-bottom: 8rpx;\n\n  .category-tag {\n    display: flex;\n    align-items: center;\n    gap: 6rpx;\n    padding: 10rpx 16rpx;\n    border: 3rpx solid $black;\n    background: $white;\n    box-shadow: 3rpx 3rpx 0 $black;\n    white-space: nowrap;\n    transition: all 0.2s ease;\n\n    .tag-emoji {\n      font-size: 24rpx;\n    }\n\n    .tag-label {\n      font-size: 24rpx;\n      font-weight: 700;\n    }\n\n    &.active {\n      background: $teal;\n      box-shadow: 3rpx 3rpx 0 $black;\n      transform: translate(-1rpx, -1rpx);\n    }\n\n    &:active {\n      transform: translate(2rpx, 2rpx);\n      box-shadow: 1rpx 1rpx 0 $black;\n    }\n  }\n}\n\n// Â∏ñÂ≠êÂàóË°®\n.post-list {\n  .post-card-wrapper {\n    margin-bottom: 24rpx;\n  }\n\n  .post-card {\n    padding: 24rpx !important;\n    margin: 0 !important;\n    cursor: pointer;\n\n    &.taped {\n      border-color: $teal;\n    }\n  }\n\n  .post-header {\n    display: flex;\n    align-items: center;\n    margin-bottom: 16rpx;\n\n    .avatar-wrapper {\n      width: 64rpx;\n      height: 64rpx;\n      border: 3rpx solid $black;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      background: linear-gradient(135deg, $yellow, #FFEAA7);\n      margin-right: 16rpx;\n      box-shadow: 3rpx 3rpx 0 $black;\n    }\n\n    .avatar-text {\n      font-size: 28rpx;\n      font-weight: 900;\n      color: $black;\n    }\n\n    .user-info {\n      flex: 1;\n\n      .username {\n        display: block;\n        font-size: 26rpx;\n        font-weight: 700;\n        margin-bottom: 4rpx;\n      }\n\n      .time {\n        font-size: 22rpx;\n        color: #999;\n      }\n    }\n\n    .pinned-badge {\n      font-size: 28rpx;\n    }\n  }\n\n  .post-title {\n    display: block;\n    font-size: 32rpx;\n    font-weight: 900;\n    margin-bottom: 12rpx;\n    color: $black;\n    line-height: 1.4;\n  }\n\n  .post-content {\n    display: block;\n    font-size: 26rpx;\n    color: #666;\n    line-height: 1.6;\n    margin-bottom: 16rpx;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: -webkit-box;\n    -webkit-line-clamp: 3;\n    -webkit-box-orient: vertical;\n  }\n\n  .post-images {\n    display: flex;\n    gap: 12rpx;\n    margin-bottom: 16rpx;\n\n    .image-wrapper {\n      position: relative;\n      width: 180rpx;\n      height: 180rpx;\n      border: 3rpx solid $black;\n      box-shadow: 3rpx 3rpx 0 $black;\n      overflow: hidden;\n    }\n\n    .post-image {\n      width: 100%;\n      height: 100%;\n    }\n\n    .more-images {\n      position: absolute;\n      bottom: 0;\n      right: 0;\n      padding: 4rpx 8rpx;\n      background: rgba(0, 0, 0, 0.7);\n      color: $white;\n      font-size: 20rpx;\n      font-weight: 700;\n    }\n  }\n\n  .post-footer {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding-top: 16rpx;\n    border-top: 2rpx dashed #ddd;\n\n    .stats {\n      display: flex;\n      gap: 24rpx;\n\n      .stat-item {\n        display: flex;\n        align-items: center;\n        gap: 4rpx;\n        font-size: 22rpx;\n        color: #666;\n        font-weight: 600;\n\n        text:first-child {\n          font-size: 24rpx;\n        }\n      }\n    }\n\n    .category-badge {\n      padding: 6rpx 12rpx;\n      border: 2rpx solid $black;\n      background: $yellow;\n      font-size: 22rpx;\n      font-weight: 700;\n      box-shadow: 2rpx 2rpx 0 $black;\n    }\n  }\n}\n\n// Á©∫Áä∂ÊÄÅ\n.empty-state {\n  padding: 64rpx 0;\n}\n\n.empty-card {\n  text-align: center;\n  padding: 48rpx 32rpx !important;\n\n  .empty-icon {\n    display: block;\n    font-size: 96rpx;\n    margin-bottom: 24rpx;\n  }\n\n  .empty-text {\n    display: block;\n    font-size: 28rpx;\n    font-weight: 700;\n    color: $black;\n    margin-bottom: 12rpx;\n  }\n\n  .empty-hint {\n    display: block;\n    font-size: 24rpx;\n    color: #999;\n  }\n}\n\n// Âä®Áîª\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n@keyframes pulse {\n  0%, 100% { transform: scale(1); }\n  50% { transform: scale(1.15); }\n}\n</style>\n","import MiniProgramPage from 'E:/codeplace/test/pages/forum/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["BrutalistCard","BrutalistButton","TabBar","userStore","useUserStore","posts","ref","currentCategory","categories","label","value","emoji","filteredPosts","computed","filter","post","category","formatTime","timestamp","date","Date","diff","getTime","Math","floor","navigateToCreate","isLoggedIn","uni","navigateTo","url","showToast","title","icon","onMounted","async","db","uniCloud","database","res","collection","orderBy","limit","get","data","e","index","__f__","_id","content","creatorName","creatorAvatar","categoryName","images","viewCount","commentCount","likeCount","createTime","now","pinned","wx","createPage","MiniProgramPage"],"mappings":"yGAqHA,MAAAA,EAA0B,IAAA,8CAC1BC,EAA4B,IAAA,gDAC5BC,EAAmB,IAAA,oFAkBb,MAAAC,EAAYC,EAAAA,eACZC,EAAQC,MAAY,IACpBC,EAAkBD,MAAY,OAG9BE,EAAa,CACjB,CAAEC,MAAO,KAAMC,MAAO,MAAOC,MAAO,MACpC,CAAEF,MAAO,KAAMC,MAAO,QAASC,MAAO,MACtC,CAAEF,MAAO,KAAMC,MAAO,OAAQC,MAAO,MACrC,CAAEF,MAAO,KAAMC,MAAO,OAAQC,MAAO,MACrC,CAAEF,MAAO,KAAMC,MAAO,QAASC,MAAO,MACtC,CAAEF,MAAO,KAAMC,MAAO,QAASC,MAAO,OAIlCC,EAAgBC,EAAAA,UAAS,IACC,QAA1BN,EAAgBG,MACXL,EAAMK,MAERL,EAAMK,MAAMI,WAAeC,EAAKC,WAAaT,EAAgBG,UAStE,SAASO,EAAWC,GACZ,MAAAC,EAAO,IAAIC,KAAKF,GAEhBG,OADUD,MACCE,UAAYH,EAAKG,UAElC,OAAID,EAAO,IACF,KACEA,EAAO,KACTE,KAAKC,MAAMH,EAAO,KAAS,MACzBA,EAAO,MACTE,KAAKC,MAAMH,EAAO,MAAW,MAE7BE,KAAKC,MAAMH,EAAO,OAAY,IAEzC,CAGA,SAASI,IACFtB,EAAUuB,WAQfC,EAAAA,MAAIC,WAAW,CACbC,IAAK,wBARLF,EAAAA,MAAIG,UAAU,CACZC,MAAO,OACPC,KAAM,QAQZ,QAwDAC,EAAAA,WAAU,MA9CVC,iBACM,IACI,MAAAC,EAAKC,KAASC,WACdC,QAAYH,EAAGI,WAAW,SAC7BC,QAAQ,aAAc,QACtBC,MAAM,IACNC,MAEHrC,EAAMK,MAAQ4B,EAAIK,IAmCpB,OAlCSC,GACPjB,EAAAkB,MAAIC,MAAM,QAAQ,+BAA+B,QAASF,GAE1DvC,EAAMK,MAAQ,CACZ,CACEqC,IAAK,IACLhB,MAAO,WACPiB,QAAS,6BACTC,YAAa,OACbC,cAAe,GACfC,aAAc,OACdnC,SAAU,QACVoC,OAAQ,GACRC,UAAW,IACXC,aAAc,GACdC,UAAW,GACXC,WAAYpC,KAAKqC,MAAQ,KACzBC,QAAQ,GAEV,CACEX,IAAK,IACLhB,MAAO,gBACPiB,QAAS,8BACTC,YAAa,QACbC,cAAe,GACfC,aAAc,OACdnC,SAAU,OACVoC,OAAQ,GACRC,UAAW,IACXC,aAAc,GACdC,UAAW,GACXC,WAAYpC,KAAKqC,MAAQ,MAG/B,CACF,4LAxFA,SAAwBzC,GACtBT,EAAgBG,MAAQM,CAC1B,+iBAmCA,SAAoBD,GAClBY,EAAAA,MAAIC,WAAW,CACbC,IAAK,0BAA0Bd,EAAKgC,OAExC,4ICxMAY,GAAGC,WAAWC"}