{"version":3,"file":"create.js","sources":["pages/forum/create.vue","../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZm9ydW0vY3JlYXRlLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"page-container\">\n    <!-- È°µÈù¢ËÉåÊôØË£ÖÈ•∞ -->\n    <view class=\"page-doodle-1\">‚ú¶</view>\n\n    <!-- ËøîÂõûÂØºËà™ -->\n    <view class=\"nav-back\" @click=\"goBack\">\n      <text class=\"back-icon\">‚Üê</text>\n      <text class=\"back-text\">ËøîÂõû</text>\n    </view>\n\n    <!-- Ê†áÈ¢òÂç°Áâá -->\n    <brutalist-card class=\"header-card\" taped accent>\n      <text class=\"header-title\">ÂèëÂ∏ÉÊñ∞Â∏ñ</text>\n      <text class=\"header-subtitle\">ÂàÜ‰∫´‰Ω†ÁöÑÊ†°Âõ≠ÁîüÊ¥ª</text>\n    </brutalist-card>\n\n    <!-- Ë°®ÂçïÂç°Áâá -->\n    <brutalist-card class=\"form-card\">\n      <!-- Ê†áÈ¢òËæìÂÖ• -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>üìù</text>\n          <text>Â∏ñÂ≠êÊ†áÈ¢ò</text>\n          <text class=\"required\">*</text>\n        </text>\n        <brutalist-input\n          v-model=\"formData.title\"\n          placeholder=\"ËØ∑ËæìÂÖ•Ê†áÈ¢òÔºà5-50Â≠óÔºâ\"\n          :maxlength=\"50\"\n          show-count\n          taped\n        />\n      </view>\n\n      <!-- ÂàÜÁ±ªÈÄâÊã© -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>üè∑Ô∏è</text>\n          <text>ÈÄâÊã©ÂàÜÁ±ª</text>\n          <text class=\"required\">*</text>\n        </text>\n        <view class=\"category-grid\">\n          <view\n            v-for=\"cat in categories\"\n            :key=\"cat.value\"\n            class=\"category-item\"\n            :class=\"{ 'active': formData.category === cat.value }\"\n            @click=\"selectCategory(cat.value)\"\n          >\n            <text class=\"cat-emoji\">{{ cat.emoji }}</text>\n            <text class=\"cat-label\">{{ cat.label }}</text>\n          </view>\n        </view>\n      </view>\n\n      <!-- ÂÜÖÂÆπËæìÂÖ• -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>‚úçÔ∏è</text>\n          <text>Â∏ñÂ≠êÂÜÖÂÆπ</text>\n          <text class=\"required\">*</text>\n        </text>\n        <view class=\"textarea-wrapper\">\n          <textarea\n            v-model=\"formData.content\"\n            class=\"form-textarea\"\n            placeholder=\"ÂàÜ‰∫´‰Ω†ÁöÑÊÉ≥Ê≥ï„ÄÅÁªèÈ™åÊàñÈóÆÈ¢ò...\"\n            :maxlength=\"500\"\n          />\n          <text class=\"char-count\">{{ formData.content.length }}/500</text>\n        </view>\n      </view>\n\n      <!-- ÂõæÁâá‰∏ä‰º† -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>üì∑</text>\n          <text>Ê∑ªÂä†ÂõæÁâá</text>\n          <text class=\"optional\">ÔºàÈÄâÂ°´Ôºâ</text>\n        </text>\n        <view class=\"image-upload\">\n          <view\n            v-for=\"(img, index) in formData.images\"\n            :key=\"index\"\n            class=\"image-item\"\n          >\n            <image class=\"upload-image\" :src=\"img\" mode=\"aspectFill\" />\n            <text class=\"image-remove\" @click=\"removeImage(index)\">√ó</text>\n          </view>\n          <view v-if=\"formData.images.length < 9\" class=\"image-add\" @click=\"chooseImage\">\n            <text class=\"add-icon\">+</text>\n            <text class=\"add-text\">Ê∑ªÂä†ÂõæÁâá</text>\n          </view>\n        </view>\n      </view>\n\n      <!-- Êèê‰∫§ÊåâÈíÆ -->\n      <brutalist-button\n        class=\"submit-btn\"\n        accent\n        taped\n        arrow\n        large\n        @click=\"submitPost\"\n      >\n        ÂèëÂ∏ÉÂ∏ñÂ≠ê\n      </brutalist-button>\n    </brutalist-card>\n\n    <!-- ÊèêÁ§∫ -->\n    <view class=\"tips\">\n      <text class=\"tips-text\">üìå ËØ∑ÈÅµÂÆàÁ§æÂå∫ËßÑËåÉÔºåÊñáÊòéÂèëË®Ä</text>\n    </view>\n  </view>\n</template>\n\n<script setup lang=\"uts\">\nimport { ref } from 'vue'\nimport { useUserStore } from '@/stores/user'\nimport BrutalistCard from '@/components/brutalist/BrutalistCard.vue'\nimport BrutalistButton from '@/components/brutalist/BrutalistButton.vue'\nimport BrutalistInput from '@/components/brutalist/BrutalistInput.vue'\n\ninterface FormData {\n  title: string\n  content: string\n  category: string\n  images: string[]\n}\n\ninterface Category {\n  label: string\n  value: string\n  emoji: string\n}\n\nconst userStore = useUserStore()\nconst formData = ref<FormData>({\n  title: '',\n  content: '',\n  category: 'study',\n  images: []\n})\n\nconst categories: Category[] = [\n  { label: 'Â≠¶‰π†‰∫§ÊµÅ', value: 'study', emoji: 'üìö' },\n  { label: 'Ê†°Âõ≠ÁîüÊ¥ª', value: 'life', emoji: 'üåü' },\n  { label: 'Â§±Áâ©ÊãõÈ¢Ü', value: 'lost', emoji: 'üîç' },\n  { label: '‰∫åÊâã‰∫§Êòì', value: 'trade', emoji: 'üí∞' },\n  { label: 'Ê¥ªÂä®ËÅö‰ºö', value: 'event', emoji: 'üéâ' }\n]\n\nfunction selectCategory(value: string) {\n  formData.value.category = value\n}\n\nfunction chooseImage() {\n  uni.chooseImage({\n    count: 9 - formData.value.images.length,\n    success: (res: any) => {\n      formData.value.images.push(...res.tempFilePaths)\n    }\n  })\n}\n\nfunction removeImage(index: number) {\n  formData.value.images.splice(index, 1)\n}\n\nfunction goBack() {\n  uni.navigateBack()\n}\n\nasync function submitPost() {\n  // Ê£ÄÊü•ÁôªÂΩï\n  if (!userStore.isLoggedIn) {\n    uni.showToast({\n      title: 'ËØ∑ÂÖàÁôªÂΩï',\n      icon: 'none'\n    })\n    return\n  }\n\n  // È™åËØÅÊ†áÈ¢ò\n  if (!formData.value.title.trim()) {\n    uni.showToast({\n      title: 'ËØ∑ËæìÂÖ•Ê†áÈ¢ò',\n      icon: 'none'\n    })\n    return\n  }\n\n  if (formData.value.title.trim().length < 5) {\n    uni.showToast({\n      title: 'Ê†áÈ¢òËá≥Â∞ë5‰∏™Â≠ó',\n      icon: 'none'\n    })\n    return\n  }\n\n  // È™åËØÅÂÜÖÂÆπ\n  if (!formData.value.content.trim()) {\n    uni.showToast({\n      title: 'ËØ∑ËæìÂÖ•ÂÜÖÂÆπ',\n      icon: 'none'\n    })\n    return\n  }\n\n  if (formData.value.content.trim().length < 10) {\n    uni.showToast({\n      title: 'ÂÜÖÂÆπËá≥Â∞ë10‰∏™Â≠ó',\n      icon: 'none'\n    })\n    return\n  }\n\n  uni.showLoading({ title: 'ÂèëÂ∏É‰∏≠...' })\n\n  try {\n    const db = uniCloud.database()\n\n    // Ëé∑ÂèñÂàÜÁ±ªÂêçÁß∞\n    const category = categories.find(c => c.value === formData.value.category)\n    const categoryName = category?.label || 'Â≠¶‰π†‰∫§ÊµÅ'\n\n    await db.collection('posts').add({\n      type: 'post',\n      title: formData.value.title,\n      content: formData.value.content,\n      category: formData.value.category,\n      categoryName: categoryName,\n      images: formData.value.images,\n      creatorName: userStore.user?.nickname || 'Ê†°Âõ≠Áî®Êà∑',\n      creatorAvatar: userStore.user?.avatar || '',\n      createTime: Date.now(),\n      viewCount: 0,\n      commentCount: 0,\n      likeCount: 0,\n      status: 'published'\n    })\n\n    uni.hideLoading()\n    uni.showToast({\n      title: 'ÂèëÂ∏ÉÊàêÂäüÔºÅ',\n      icon: 'success'\n    })\n\n    setTimeout(() => {\n      uni.navigateBack()\n    }, 1500)\n  } catch (e) {\n    uni.hideLoading()\n    uni.__f__('error','at pages/forum/create.vue:255','ÂèëÂ∏ÉÂ§±Ë¥•:', e)\n\n    // ÈôçÁ∫ßÂ§ÑÁêÜÔºö‰ΩøÁî®Êú¨Âú∞Â≠òÂÇ®Ê®°Êãü\n    const mockPost = {\n      _id: 'post_' + Date.now(),\n      title: formData.value.title,\n      content: formData.value.content,\n      category: formData.value.category,\n      categoryName: categories.find(c => c.value === formData.value.category)?.label || 'Â≠¶‰π†‰∫§ÊµÅ',\n      images: formData.value.images,\n      creatorName: userStore.user?.nickname || 'Ê†°Âõ≠Áî®Êà∑',\n      creatorAvatar: '',\n      createTime: Date.now(),\n      viewCount: 0,\n      commentCount: 0,\n      likeCount: 0\n    }\n\n    // ‰øùÂ≠òÂà∞Êú¨Âú∞\n    const posts = uni.getStorageSync('mock_posts') || []\n    posts.unshift(mockPost)\n    uni.setStorageSync('mock_posts', posts)\n\n    uni.showToast({\n      title: 'ÂèëÂ∏ÉÊàêÂäüÔºàÊú¨Âú∞Ôºâ',\n      icon: 'success'\n    })\n\n    setTimeout(() => {\n      uni.navigateBack()\n    }, 1500)\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n// ÈáéÂÖΩÊ¥æÈÖçËâ≤ÊñπÊ°à\n$black: #000000;\n$white: #ffffff;\n$red: #FF6B6B;\n$teal: #4ECDC4;\n$yellow: #FFE66D;\n\n.page-container {\n  min-height: 100vh;\n  padding: 24rpx;\n  padding-bottom: 48rpx;\n  background: linear-gradient(180deg, #F0FFF4 0%, #ffffff 50%, #FFF9E6 100%);\n  position: relative;\n}\n\n// ËÉåÊôØÊ∂ÇÈ∏¶\n.page-doodle-1 {\n  position: fixed;\n  top: 100rpx;\n  right: 30rpx;\n  font-size: 40rpx;\n  color: $yellow;\n  opacity: 0.3;\n  animation: spin 10s linear infinite;\n  z-index: 0;\n}\n\n// ËøîÂõûÂØºËà™\n.nav-back {\n  display: flex;\n  align-items: center;\n  margin-bottom: 24rpx;\n  padding: 12rpx 0;\n\n  .back-icon {\n    font-size: 36rpx;\n    font-weight: 900;\n    margin-right: 8rpx;\n  }\n\n  .back-text {\n    font-size: 26rpx;\n    font-weight: 700;\n  }\n}\n\n// Ê†áÈ¢òÂç°Áâá\n.header-card {\n  text-align: center;\n  padding: 32rpx 24rpx !important;\n  margin-bottom: 24rpx !important;\n\n  .header-title {\n    display: block;\n    font-size: 40rpx;\n    font-weight: 900;\n    color: $black;\n    margin-bottom: 8rpx;\n  }\n\n  .header-subtitle {\n    display: block;\n    font-size: 24rpx;\n    color: #666;\n  }\n}\n\n// Ë°®ÂçïÂç°Áâá\n.form-card {\n  padding: 32rpx 24rpx !important;\n}\n\n.form-group {\n  margin-bottom: 32rpx;\n\n  .form-label {\n    display: flex;\n    align-items: center;\n    gap: 8rpx;\n    margin-bottom: 12rpx;\n    font-size: 26rpx;\n    font-weight: 900;\n\n    text:first-child {\n      font-size: 28rpx;\n    }\n\n    .required {\n      color: $red;\n    }\n\n    .optional {\n      font-size: 22rpx;\n      color: #999;\n      font-weight: 400;\n    }\n  }\n}\n\n// ÂàÜÁ±ªÁΩëÊ†º\n.category-grid {\n  display: grid;\n  grid-template-columns: repeat(5, 1fr);\n  gap: 12rpx;\n}\n\n.category-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 16rpx 8rpx;\n  border: 3rpx solid $black;\n  background: $white;\n  box-shadow: 3rpx 3rpx 0 $black;\n  transition: all 0.2s ease;\n\n  .cat-emoji {\n    font-size: 32rpx;\n    margin-bottom: 6rpx;\n  }\n\n  .cat-label {\n    font-size: 20rpx;\n    font-weight: 700;\n  }\n\n  &.active {\n    background: $teal;\n    transform: translate(-2rpx, -2rpx);\n    box-shadow: 5rpx 5rpx 0 $black;\n  }\n\n  &:active {\n    transform: translate(2rpx, 2rpx);\n    box-shadow: 1rpx 1rpx 0 $black;\n  }\n}\n\n// ÊñáÊú¨Âüü\n.textarea-wrapper {\n  position: relative;\n\n  .form-textarea {\n    width: 100%;\n    min-height: 240rpx;\n    padding: 20rpx;\n    border: 4rpx solid $black;\n    background: $white;\n    font-size: 28rpx;\n    line-height: 1.6;\n    box-shadow: 4rpx 4rpx 0 $black;\n\n    // ‰∏çËßÑÂàôËæπÁºò\n    clip-path: polygon(\n      1% 0%, 98% 1%, 99% 98%, 1% 100%\n    );\n  }\n\n  .char-count {\n    position: absolute;\n    bottom: 16rpx;\n    right: 16rpx;\n    font-size: 22rpx;\n    color: #999;\n  }\n}\n\n// ÂõæÁâá‰∏ä‰º†\n.image-upload {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 16rpx;\n}\n\n.image-item {\n  position: relative;\n  width: 160rpx;\n  height: 160rpx;\n  border: 3rpx solid $black;\n  box-shadow: 3rpx 3rpx 0 $black;\n}\n\n.upload-image {\n  width: 100%;\n  height: 100%;\n}\n\n.image-remove {\n  position: absolute;\n  top: -8rpx;\n  right: -8rpx;\n  width: 40rpx;\n  height: 40rpx;\n  background: $red;\n  color: $white;\n  border: 2rpx solid $black;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 28rpx;\n  font-weight: 900;\n}\n\n.image-add {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 160rpx;\n  height: 160rpx;\n  border: 3rpx dashed $black;\n  background: #F5F5F5;\n\n  .add-icon {\n    font-size: 48rpx;\n    color: #999;\n    margin-bottom: 8rpx;\n  }\n\n  .add-text {\n    font-size: 22rpx;\n    color: #999;\n  }\n}\n\n.submit-btn {\n  width: 100%;\n  margin-top: 24rpx;\n}\n\n// ÊèêÁ§∫\n.tips {\n  text-align: center;\n  padding: 24rpx;\n\n  .tips-text {\n    font-size: 24rpx;\n    color: #999;\n  }\n}\n\n// Âä®Áîª\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n</style>\n","import MiniProgramPage from 'E:/codeplace/test/pages/forum/create.vue'\nwx.createPage(MiniProgramPage)"],"names":["BrutalistCard","BrutalistButton","BrutalistInput","userStore","useUserStore","formData","ref","title","content","category","images","categories","label","value","emoji","chooseImage","uni","count","length","success","res","push","tempFilePaths","goBack","index","navigateBack","async","submitPost","isLoggedIn","trim","showToast","icon","showLoading","db","uniCloud","database","find","c","categoryName","collection","add","type","creatorName","_a","user","nickname","creatorAvatar","_b","avatar","createTime","Date","now","viewCount","commentCount","likeCount","status","hideLoading","setTimeout","e","__f__","mockPost","_id","_c","_d","posts","getStorageSync","unshift","setStorageSync","splice","wx","createPage","MiniProgramPage"],"mappings":"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"}