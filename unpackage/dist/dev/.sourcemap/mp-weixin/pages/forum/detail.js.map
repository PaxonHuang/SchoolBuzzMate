{"version":3,"file":"detail.js","sources":["pages/forum/detail.vue","../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZm9ydW0vZGV0YWlsLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"page-container\">\n    <!-- È°µÈù¢ËÉåÊôØË£ÖÈ•∞ -->\n    <view class=\"page-doodle-1\">‚ú¶</view>\n\n    <!-- ËøîÂõûÂØºËà™ -->\n    <view class=\"nav-back\" @click=\"goBack\">\n      <text class=\"back-icon\">‚Üê</text>\n      <text class=\"back-text\">ËøîÂõû</text>\n    </view>\n\n    <view v-if=\"post\" class=\"content-wrapper\">\n      <!-- Â∏ñÂ≠êËØ¶ÊÉÖÂç°Áâá -->\n      <brutalist-card class=\"post-detail-card\" taped>\n        <!-- Â∏ñÂ≠êÂ§¥ÈÉ® -->\n        <view class=\"post-header\">\n          <view class=\"author-avatar\">\n            <text>{{ post.creatorName?.charAt(0) || 'U' }}</text>\n          </view>\n          <view class=\"author-info\">\n            <text class=\"author-name\">{{ post.creatorName }}</text>\n            <text class=\"post-time\">{{ formatTime(post.createTime) }}</text>\n          </view>\n          <view class=\"post-category\">\n            <text>{{ post.categoryName }}</text>\n          </view>\n        </view>\n\n        <!-- Â∏ñÂ≠êÊ†áÈ¢ò -->\n        <text class=\"post-title\">{{ post.title }}</text>\n\n        <!-- Â∏ñÂ≠êÂÜÖÂÆπ -->\n        <text class=\"post-content\">{{ post.content }}</text>\n\n        <!-- Â∏ñÂ≠êÂõæÁâá -->\n        <view v-if=\"post.images && post.images.length > 0\" class=\"post-images\">\n          <view\n            v-for=\"(img, index) in post.images\"\n            :key=\"index\"\n            class=\"image-wrapper\"\n          >\n            <image class=\"post-image\" :src=\"img\" mode=\"aspectFill\" @click=\"previewImage(index)\" />\n          </view>\n        </view>\n\n        <!-- Â∏ñÂ≠êÁªüËÆ° -->\n        <view class=\"post-stats\">\n          <view class=\"stat-item\">\n            <text>üëÅ</text>\n            <text>{{ post.viewCount || 0 }}</text>\n          </view>\n          <view class=\"stat-item\">\n            <text>üí¨</text>\n            <text>{{ post.commentCount || 0 }}</text>\n          </view>\n          <view class=\"stat-item\">\n            <text>üëç</text>\n            <text>{{ post.likeCount || 0 }}</text>\n          </view>\n        </view>\n      </brutalist-card>\n\n      <!-- ËØÑËÆ∫Âå∫ -->\n      <brutalist-card class=\"comments-card\" dashed>\n        <view class=\"comments-header\">\n          <text class=\"comments-title\">üí¨ ËØÑËÆ∫</text>\n          <text class=\"comments-count\">{{ comments.length }}Êù°</text>\n        </view>\n\n        <!-- ËØÑËÆ∫ËæìÂÖ• -->\n        <view class=\"comment-input-wrapper\">\n          <input\n            v-model=\"commentText\"\n            class=\"comment-input\"\n            placeholder=\"ËØ¥ÁÇπ‰ªÄ‰πà...\"\n          />\n          <brutalist-button\n            class=\"comment-btn\"\n            accent\n            @click=\"submitComment\"\n          >\n            ÂèëÈÄÅ\n          </brutalist-button>\n        </view>\n\n        <!-- ËØÑËÆ∫ÂàóË°® -->\n        <view v-if=\"comments.length > 0\" class=\"comment-list\">\n          <view\n            v-for=\"comment in comments\"\n            :key=\"comment._id\"\n            class=\"comment-item\"\n          >\n            <view class=\"comment-avatar\">\n              <text>{{ comment.userName?.charAt(0) || 'U' }}</text>\n            </view>\n            <view class=\"comment-content\">\n              <text class=\"comment-user\">{{ comment.userName }}</text>\n              <text class=\"comment-text\">{{ comment.content }}</text>\n              <text class=\"comment-time\">{{ formatTime(comment.createTime) }}</text>\n            </view>\n          </view>\n        </view>\n\n        <view v-else class=\"empty-comments\">\n          <text>ÊöÇÊó†ËØÑËÆ∫ÔºåÂø´Êù•Êä¢Ê≤ôÂèë~</text>\n        </view>\n      </brutalist-card>\n    </view>\n\n    <!-- Âä†ËΩΩ‰∏≠ -->\n    <view v-else class=\"loading\">\n      <brutalist-card class=\"loading-card\" dashed>\n        <text class=\"loading-text\">Âä†ËΩΩ‰∏≠...</text>\n      </brutalist-card>\n    </view>\n  </view>\n</template>\n\n<script setup lang=\"uts\">\nimport { ref, onMounted } from 'vue'\nimport BrutalistCard from '@/components/brutalist/BrutalistCard.vue'\nimport BrutalistButton from '@/components/brutalist/BrutalistButton.vue'\n\ninterface Post {\n  _id: string\n  title: string\n  content: string\n  creatorName: string\n  categoryName: string\n  images: string[]\n  viewCount: number\n  commentCount: number\n  likeCount: number\n  createTime: number\n}\n\ninterface Comment {\n  _id: string\n  userName: string\n  content: string\n  createTime: number\n}\n\nconst post = ref<Post | null>(null)\nconst comments = ref<Comment[]>([])\nconst commentText = ref('')\nconst postId = ref('')\n\n// Ê†ºÂºèÂåñÊó∂Èó¥\nfunction formatTime(timestamp: number): string {\n  const date = new Date(timestamp)\n  const now = new Date()\n  const diff = now.getTime() - date.getTime()\n\n  if (diff < 60000) {\n    return 'ÂàöÂàö'\n  } else if (diff < 3600000) {\n    return Math.floor(diff / 60000) + 'ÂàÜÈíüÂâç'\n  } else if (diff < 86400000) {\n    return Math.floor(diff / 3600000) + 'Â∞èÊó∂Ââç'\n  } else {\n    return Math.floor(diff / 86400000) + 'Â§©Ââç'\n  }\n}\n\nfunction goBack() {\n  uni.navigateBack()\n}\n\nfunction previewImage(index: number) {\n  if (post.value?.images) {\n    uni.previewImage({\n      urls: post.value.images,\n      current: index\n    })\n  }\n}\n\nfunction submitComment() {\n  if (!commentText.value.trim()) {\n    uni.showToast({\n      title: 'ËØ∑ËæìÂÖ•ËØÑËÆ∫ÂÜÖÂÆπ',\n      icon: 'none'\n    })\n    return\n  }\n\n  // Ê®°ÊãüÊ∑ªÂä†ËØÑËÆ∫\n  const newComment: Comment = {\n    _id: 'comment_' + Date.now(),\n    userName: 'Êàë',\n    content: commentText.value,\n    createTime: Date.now()\n  }\n\n  comments.value.unshift(newComment)\n  commentText.value = ''\n\n  uni.showToast({\n    title: 'ËØÑËÆ∫ÊàêÂäü',\n    icon: 'success'\n  })\n}\n\nasync function loadPost() {\n  // Ëé∑ÂèñÈ°µÈù¢ÂèÇÊï∞\n  const pages = getCurrentPages()\n  const currentPage = pages[pages.length - 1]\n  const options = (currentPage as any).options || {}\n  postId.value = options.id || ''\n\n  if (!postId.value) {\n    uni.showToast({\n      title: 'Â∏ñÂ≠ê‰∏çÂ≠òÂú®',\n      icon: 'none'\n    })\n    setTimeout(() => {\n      uni.navigateBack()\n    }, 1500)\n    return\n  }\n\n  try {\n    const db = uniCloud.database()\n    const res = await db.collection('posts')\n      .doc(postId.value)\n      .get()\n\n    if (res.data && res.data.length > 0) {\n      post.value = res.data[0] as Post\n\n      // Âä†ËΩΩËØÑËÆ∫\n      loadComments()\n    } else {\n      // ‰ΩøÁî®Ê®°ÊãüÊï∞ÊçÆ\n      post.value = {\n        _id: postId.value,\n        title: 'Âõæ‰π¶È¶ÜÁ∫¶Â≠¶‰π†Êê≠Â≠ê',\n        content: 'ÊòéÂ§©‰∏ãÂçà2ÁÇπÔºåÂõæ‰π¶È¶Ü‰∏âÊ•ºÔºåÊúâÊ≤°Êúâ‰∏ÄËµ∑Â§ç‰π†È´òÊï∞ÁöÑÂêåÂ≠¶ÔºüÂèØ‰ª•‰∏ÄËµ∑ËÆ®ËÆ∫ÈóÆÈ¢òÔºå‰∫íÁõ∏ÁõëÁù£ÔºÅ',\n        creatorName: 'Â≠¶‰π†Ëææ‰∫∫',\n        categoryName: 'Â≠¶‰π†‰∫§ÊµÅ',\n        images: [],\n        viewCount: 128,\n        commentCount: 15,\n        likeCount: 32,\n        createTime: Date.now() - 3600000\n      }\n    }\n  } catch (e) {\n    uni.__f__('error','at pages/forum/detail.vue:250','Âä†ËΩΩÂ§±Ë¥•:', e)\n    // ‰ΩøÁî®Ê®°ÊãüÊï∞ÊçÆ\n    post.value = {\n      _id: postId.value,\n      title: 'Âõæ‰π¶È¶ÜÁ∫¶Â≠¶‰π†Êê≠Â≠ê',\n      content: 'ÊòéÂ§©‰∏ãÂçà2ÁÇπÔºåÂõæ‰π¶È¶Ü‰∏âÊ•ºÔºåÊúâÊ≤°Êúâ‰∏ÄËµ∑Â§ç‰π†È´òÊï∞ÁöÑÂêåÂ≠¶ÔºüÂèØ‰ª•‰∏ÄËµ∑ËÆ®ËÆ∫ÈóÆÈ¢òÔºå‰∫íÁõ∏ÁõëÁù£ÔºÅ',\n      creatorName: 'Â≠¶‰π†Ëææ‰∫∫',\n      categoryName: 'Â≠¶‰π†‰∫§ÊµÅ',\n      images: [],\n      viewCount: 128,\n      commentCount: 15,\n      likeCount: 32,\n      createTime: Date.now() - 3600000\n    }\n  }\n}\n\nasync function loadComments() {\n  // Ê®°ÊãüËØÑËÆ∫Êï∞ÊçÆ\n  comments.value = [\n    {\n      _id: '1',\n      userName: 'ÂêåÂ≠¶A',\n      content: 'Êàë‰πüÂú®Â§ç‰π†È´òÊï∞Ôºå‰∏ÄËµ∑ÂêßÔºÅ',\n      createTime: Date.now() - 1800000\n    },\n    {\n      _id: '2',\n      userName: 'ÂêåÂ≠¶B',\n      content: 'Âá†ÁÇπËßÅÈù¢Ôºü',\n      createTime: Date.now() - 900000\n    }\n  ]\n}\n\nonMounted(() => {\n  loadPost()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n// ÈáéÂÖΩÊ¥æÈÖçËâ≤ÊñπÊ°à\n$black: #000000;\n$white: #ffffff;\n$red: #FF6B6B;\n$teal: #4ECDC4;\n$yellow: #FFE66D;\n\n.page-container {\n  min-height: 100vh;\n  padding: 24rpx;\n  padding-bottom: 48rpx;\n  background: linear-gradient(180deg, #F0FFF4 0%, #ffffff 50%, #FFF9E6 100%);\n  position: relative;\n}\n\n// ËÉåÊôØÊ∂ÇÈ∏¶\n.page-doodle-1 {\n  position: fixed;\n  top: 100rpx;\n  right: 30rpx;\n  font-size: 40rpx;\n  color: $yellow;\n  opacity: 0.3;\n  animation: spin 10s linear infinite;\n  z-index: 0;\n}\n\n// ËøîÂõûÂØºËà™\n.nav-back {\n  display: flex;\n  align-items: center;\n  margin-bottom: 24rpx;\n  padding: 12rpx 0;\n\n  .back-icon {\n    font-size: 36rpx;\n    font-weight: 900;\n    margin-right: 8rpx;\n  }\n\n  .back-text {\n    font-size: 26rpx;\n    font-weight: 700;\n  }\n}\n\n// Â∏ñÂ≠êËØ¶ÊÉÖÂç°Áâá\n.post-detail-card {\n  padding: 32rpx 24rpx !important;\n  margin-bottom: 24rpx !important;\n}\n\n.post-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 24rpx;\n\n  .author-avatar {\n    width: 72rpx;\n    height: 72rpx;\n    border: 3rpx solid $black;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: linear-gradient(135deg, $yellow, #FFEAA7);\n    margin-right: 16rpx;\n    box-shadow: 3rpx 3rpx 0 $black;\n\n    text {\n      font-size: 32rpx;\n      font-weight: 900;\n      color: $black;\n    }\n  }\n\n  .author-info {\n    flex: 1;\n\n    .author-name {\n      display: block;\n      font-size: 28rpx;\n      font-weight: 700;\n      margin-bottom: 4rpx;\n    }\n\n    .post-time {\n      font-size: 22rpx;\n      color: #999;\n    }\n  }\n\n  .post-category {\n    padding: 6rpx 12rpx;\n    border: 2rpx solid $black;\n    background: $teal;\n    font-size: 22rpx;\n    font-weight: 700;\n  }\n}\n\n.post-title {\n  display: block;\n  font-size: 36rpx;\n  font-weight: 900;\n  color: $black;\n  line-height: 1.4;\n  margin-bottom: 20rpx;\n}\n\n.post-content {\n  display: block;\n  font-size: 28rpx;\n  color: #333;\n  line-height: 1.7;\n  margin-bottom: 24rpx;\n}\n\n.post-images {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 12rpx;\n  margin-bottom: 24rpx;\n\n  .image-wrapper {\n    width: 220rpx;\n    height: 220rpx;\n    border: 3rpx solid $black;\n    box-shadow: 3rpx 3rpx 0 $black;\n    overflow: hidden;\n  }\n\n  .post-image {\n    width: 100%;\n    height: 100%;\n  }\n}\n\n.post-stats {\n  display: flex;\n  gap: 32rpx;\n  padding-top: 20rpx;\n  border-top: 2rpx dashed #ddd;\n\n  .stat-item {\n    display: flex;\n    align-items: center;\n    gap: 6rpx;\n    font-size: 24rpx;\n    color: #666;\n    font-weight: 600;\n\n    text:first-child {\n      font-size: 26rpx;\n    }\n  }\n}\n\n// ËØÑËÆ∫Âå∫\n.comments-card {\n  padding: 24rpx !important;\n}\n\n.comments-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20rpx;\n\n  .comments-title {\n    font-size: 28rpx;\n    font-weight: 900;\n  }\n\n  .comments-count {\n    font-size: 24rpx;\n    color: #999;\n  }\n}\n\n.comment-input-wrapper {\n  display: flex;\n  gap: 12rpx;\n  margin-bottom: 24rpx;\n\n  .comment-input {\n    flex: 1;\n    padding: 16rpx;\n    border: 3rpx solid $black;\n    background: $white;\n    font-size: 26rpx;\n  }\n\n  .comment-btn {\n    padding: 12rpx 24rpx !important;\n  }\n}\n\n.comment-list {\n  .comment-item {\n    display: flex;\n    gap: 12rpx;\n    padding: 16rpx 0;\n    border-bottom: 1rpx solid #eee;\n\n    &:last-child {\n      border-bottom: none;\n    }\n  }\n\n  .comment-avatar {\n    width: 56rpx;\n    height: 56rpx;\n    border: 2rpx solid $black;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: #F5F5F5;\n    flex-shrink: 0;\n\n    text {\n      font-size: 24rpx;\n      font-weight: 700;\n      color: $black;\n    }\n  }\n\n  .comment-content {\n    flex: 1;\n\n    .comment-user {\n      display: block;\n      font-size: 24rpx;\n      font-weight: 700;\n      color: $black;\n      margin-bottom: 6rpx;\n    }\n\n    .comment-text {\n      display: block;\n      font-size: 26rpx;\n      color: #333;\n      line-height: 1.5;\n      margin-bottom: 8rpx;\n    }\n\n    .comment-time {\n      font-size: 22rpx;\n      color: #999;\n    }\n  }\n}\n\n.empty-comments {\n  text-align: center;\n  padding: 48rpx 0;\n  color: #999;\n  font-size: 26rpx;\n}\n\n// Âä†ËΩΩ‰∏≠\n.loading {\n  padding: 64rpx 0;\n\n  .loading-card {\n    text-align: center;\n    padding: 48rpx 32rpx !important;\n\n    .loading-text {\n      font-size: 28rpx;\n      color: #999;\n    }\n  }\n}\n\n// Âä®Áîª\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n</style>\n","import MiniProgramPage from 'E:/codeplace/test/pages/forum/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["BrutalistCard","BrutalistButton","post","ref","comments","commentText","postId","formatTime","timestamp","date","Date","diff","getTime","Math","floor","goBack","uni","index","navigateBack","submitComment","value","trim","showToast","title","icon","newComment","_id","now","userName","content","createTime","unshift","async","loadPost","pages","getCurrentPages","options","length","id","setTimeout","db","uniCloud","database","res","collection","doc","get","data","creatorName","categoryName","images","viewCount","commentCount","likeCount","e","__f__","onMounted","_a","previewImage","urls","current","wx","createPage","MiniProgramPage"],"mappings":"qEAwHA,MAAAA,EAA0B,IAAA,8CAC1BC,EAA4B,IAAA,8FAsBtB,MAAAC,EAAOC,MAAiB,MACxBC,EAAWD,MAAe,IAC1BE,EAAcF,MAAI,IAClBG,EAASH,MAAI,IAGnB,SAASI,EAAWC,GACZ,MAAAC,EAAO,IAAIC,KAAKF,GAEhBG,OADUD,MACCE,UAAYH,EAAKG,UAElC,OAAID,EAAO,IACF,KACEA,EAAO,KACTE,KAAKC,MAAMH,EAAO,KAAS,MACzBA,EAAO,MACTE,KAAKC,MAAMH,EAAO,MAAW,MAE7BE,KAAKC,MAAMH,EAAO,OAAY,IAEzC,CAEA,SAASI,IACPC,EAAAC,MAAIC,cACN,CAWA,SAASC,IACP,IAAKd,EAAYe,MAAMC,OAKrB,YAJAL,EAAAA,MAAIM,UAAU,CACZC,MAAO,UACPC,KAAM,SAMV,MAAMC,EAAsB,CAC1BC,IAAK,WAAahB,KAAKiB,MACvBC,SAAU,IACVC,QAASxB,EAAYe,MACrBU,WAAYpB,KAAKiB,OAGVvB,EAAAgB,MAAMW,QAAQN,GACvBpB,EAAYe,MAAQ,GAEpBJ,EAAAA,MAAIM,UAAU,CACZC,MAAO,OACPC,KAAM,WAEV,CAEAQ,eAAeC,IAEb,MAAMC,EAAQC,kBAERC,EADcF,EAAMA,EAAMG,OAAS,GACJD,SAAW,GAG5C,GAFG9B,EAAAc,MAAQgB,EAAQE,IAAM,IAExBhC,EAAOc,MAQV,OAPAJ,EAAAA,MAAIM,UAAU,CACZC,MAAO,QACPC,KAAM,cAERe,YAAW,KACTvB,EAAAC,MAAIC,cAAa,GAChB,MAID,IACI,MAAAsB,EAAKC,KAASC,WACdC,QAAYH,EAAGI,WAAW,SAC7BC,IAAIvC,EAAOc,OACX0B,MAECH,EAAII,MAAQJ,EAAII,KAAKV,OAAS,GAC3BnC,EAAAkB,MAAQuB,EAAII,KAAK,GAqC5Bf,iBAEE5B,EAASgB,MAAQ,CACf,CACEM,IAAK,IACLE,SAAU,MACVC,QAAS,eACTC,WAAYpB,KAAKiB,MAAQ,MAE3B,CACED,IAAK,IACLE,SAAU,MACVC,QAAS,QACTC,WAAYpB,KAAKiB,MAAQ,KAG/B,KA/CMzB,EAAKkB,MAAQ,CACXM,IAAKpB,EAAOc,MACZG,MAAO,WACPM,QAAS,2CACTmB,YAAa,OACbC,aAAc,OACdC,OAAQ,GACRC,UAAW,IACXC,aAAc,GACdC,UAAW,GACXvB,WAAYpB,KAAKiB,MAAQ,KAkB/B,OAfS2B,GACPtC,EAAAC,MAAIsC,MAAM,QAAQ,gCAAgC,QAASD,GAE3DpD,EAAKkB,MAAQ,CACXM,IAAKpB,EAAOc,MACZG,MAAO,WACPM,QAAS,2CACTmB,YAAa,OACbC,aAAc,OACdC,OAAQ,GACRC,UAAW,IACXC,aAAc,GACdC,UAAW,GACXvB,WAAYpB,KAAKiB,MAAQ,KAE7B,CACF,QAoBA6B,EAAAA,WAAU,yYAnHV,SAAsBvC,UAChB,OAAAwC,EAAAvD,EAAKkB,YAAL,EAAAqC,EAAYP,SACdlC,EAAAA,MAAI0C,aAAa,CACfC,KAAMzD,EAAKkB,MAAM8B,OACjBU,QAAS3C,GAGf,+gBC/KA4C,GAAGC,WAAWC"}