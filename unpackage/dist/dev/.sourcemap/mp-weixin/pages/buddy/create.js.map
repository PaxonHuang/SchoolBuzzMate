{"version":3,"file":"create.js","sources":["pages/buddy/create.vue","../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYnVkZHkvY3JlYXRlLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"page-container\">\n    <!-- È°µÈù¢ËÉåÊôØË£ÖÈ•∞ -->\n    <view class=\"page-doodle-1\">‚ú¶</view>\n\n    <!-- ËøîÂõûÂØºËà™ -->\n    <view class=\"nav-back\" @click=\"goBack\">\n      <text class=\"back-icon\">‚Üê</text>\n      <text class=\"back-text\">ËøîÂõû</text>\n    </view>\n\n    <!-- Ê†áÈ¢òÂç°Áâá -->\n    <brutalist-card class=\"header-card\" taped accent>\n      <text class=\"header-title\">ÂèëÂ∏ÉÊâæÊê≠Â≠ê</text>\n      <text class=\"header-subtitle\">ÂØªÊâæÂøóÂêåÈÅìÂêàÁöÑ‰ºô‰º¥</text>\n    </brutalist-card>\n\n    <!-- Ë°®ÂçïÂç°Áâá -->\n    <brutalist-card class=\"form-card\">\n      <!-- Ê†áÈ¢òËæìÂÖ• -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>üìù</text>\n          <text>Ê¥ªÂä®Ê†áÈ¢ò</text>\n          <text class=\"required\">*</text>\n        </text>\n        <brutalist-input\n          v-model=\"formData.title\"\n          placeholder=\"‰æãÂ¶ÇÔºöÂØªÊâæÂë®‰∏âÂõæ‰π¶È¶ÜËá™‰π†‰ºô‰º¥\"\n          :maxlength=\"30\"\n          show-count\n          taped\n        />\n      </view>\n\n      <!-- Ê¥ªÂä®Á±ªÂûã -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>üè∑Ô∏è</text>\n          <text>Ê¥ªÂä®Á±ªÂûã</text>\n          <text class=\"required\">*</text>\n        </text>\n        <view class=\"tag-grid\">\n          <view\n            v-for=\"tag in buddyTags\"\n            :key=\"tag\"\n            class=\"tag-item\"\n            :class=\"{ 'active': formData.tags.includes(tag) }\"\n            @click=\"toggleTag(tag)\"\n          >\n            <text>{{ getTagEmoji(tag) }}</text>\n            <text>{{ tag }}</text>\n          </view>\n        </view>\n      </view>\n\n      <!-- ËØ¶ÁªÜÊèèËø∞ -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>‚úçÔ∏è</text>\n          <text>Ê¥ªÂä®ÊèèËø∞</text>\n          <text class=\"required\">*</text>\n        </text>\n        <view class=\"textarea-wrapper\">\n          <textarea\n            v-model=\"formData.description\"\n            class=\"form-textarea\"\n            placeholder=\"ËØ¶ÁªÜËØ¥Êòé‰Ω†ÁöÑÈúÄÊ±ÇÔºåÂåÖÊã¨Êó∂Èó¥„ÄÅÂú∞ÁÇπÁ≠â...\"\n            :maxlength=\"300\"\n          />\n          <text class=\"char-count\">{{ formData.description.length }}/300</text>\n        </view>\n      </view>\n\n      <!-- ‰∫∫Êï∞ÈôêÂà∂ -->\n      <view class=\"form-group\">\n        <text class=\"form-label\">\n          <text>üë•</text>\n          <text>‰∫∫Êï∞ÈôêÂà∂</text>\n          <text class=\"optional\">ÔºàÈÄâÂ°´Ôºâ</text>\n        </text>\n        <view class=\"participant-selector\">\n          <view\n            v-for=\"num in [2, 3, 4, 6, 8]\"\n            :key=\"num\"\n            class=\"participant-item\"\n            :class=\"{ 'active': formData.maxParticipants === num }\"\n            @click=\"selectParticipants(num)\"\n          >\n            <text>{{ num }}‰∫∫</text>\n          </view>\n          <view\n            class=\"participant-item\"\n            :class=\"{ 'active': formData.maxParticipants === 0 }\"\n            @click=\"selectParticipants(0)\"\n          >\n            <text>‰∏çÈôê</text>\n          </view>\n        </view>\n      </view>\n\n      <!-- Êèê‰∫§ÊåâÈíÆ -->\n      <brutalist-button\n        class=\"submit-btn\"\n        accent\n        taped\n        arrow\n        large\n        @click=\"submitRequest\"\n      >\n        ÂèëÂ∏ÉÈúÄÊ±Ç\n      </brutalist-button>\n    </brutalist-card>\n\n    <!-- ÊèêÁ§∫ -->\n    <view class=\"tips\">\n      <text class=\"tips-text\">üí° ÂèëÂ∏ÉÂêé‰ºöÂ±ïÁ§∫ÁªôÊâÄÊúâÂêåÂ≠¶ÔºåËØ∑Á°Æ‰øù‰ø°ÊÅØÁúüÂÆû</text>\n    </view>\n  </view>\n</template>\n\n<script setup lang=\"uts\">\nimport { ref } from 'vue'\nimport { useUserStore } from '@/stores/user'\nimport BrutalistCard from '@/components/brutalist/BrutalistCard.vue'\nimport BrutalistButton from '@/components/brutalist/BrutalistButton.vue'\nimport BrutalistInput from '@/components/brutalist/BrutalistInput.vue'\n\ninterface FormData {\n  title: string\n  description: string\n  tags: string[]\n  maxParticipants: number\n}\n\nconst userStore = useUserStore()\nconst formData = ref<FormData>({\n  title: '',\n  description: '',\n  tags: [],\n  maxParticipants: 0\n})\n\nconst buddyTags = [\n  'Â≠¶‰π†', 'ËøêÂä®', 'ÊóÖÊ∏∏', 'È•≠Êê≠Â≠ê', 'Âõæ‰π¶È¶Ü',\n  'ÁØÆÁêÉ', 'Ë∂≥ÁêÉ', 'ÁæΩÊØõÁêÉ', 'Ëá™‰π†', 'ËÄÉËØï'\n]\n\nfunction getTagEmoji(tag: string): string {\n  const emojiMap: Record<string, string> = {\n    'Â≠¶‰π†': 'üìö',\n    'ËøêÂä®': 'üèÉ',\n    'ÊóÖÊ∏∏': '‚úàÔ∏è',\n    'È•≠Êê≠Â≠ê': 'üçú',\n    'Âõæ‰π¶È¶Ü': 'üìñ',\n    'ÁØÆÁêÉ': 'üèÄ',\n    'Ë∂≥ÁêÉ': '‚öΩ',\n    'ÁæΩÊØõÁêÉ': 'üè∏',\n    'Ëá™‰π†': '‚úçÔ∏è',\n    'ËÄÉËØï': 'üìù'\n  }\n  return emojiMap[tag] || 'üè∑Ô∏è'\n}\n\nfunction toggleTag(tag: string) {\n  const index = formData.value.tags.indexOf(tag)\n  if (index === -1) {\n    formData.value.tags.push(tag)\n  } else {\n    formData.value.tags.splice(index, 1)\n  }\n}\n\nfunction selectParticipants(num: number) {\n  formData.value.maxParticipants = num\n}\n\nfunction goBack() {\n  uni.navigateBack()\n}\n\nasync function submitRequest() {\n  // Ê£ÄÊü•ÁôªÂΩï\n  if (!userStore.isLoggedIn) {\n    uni.showToast({\n      title: 'ËØ∑ÂÖàÁôªÂΩï',\n      icon: 'none'\n    })\n    return\n  }\n\n  // È™åËØÅÊ†áÈ¢ò\n  if (!formData.value.title.trim()) {\n    uni.showToast({\n      title: 'ËØ∑ËæìÂÖ•Ê†áÈ¢ò',\n      icon: 'none'\n    })\n    return\n  }\n\n  // È™åËØÅÁ±ªÂûã\n  if (formData.value.tags.length === 0) {\n    uni.showToast({\n      title: 'ËØ∑ÈÄâÊã©Ëá≥Â∞ë‰∏Ä‰∏™Á±ªÂûã',\n      icon: 'none'\n    })\n    return\n  }\n\n  // È™åËØÅÊèèËø∞\n  if (!formData.value.description.trim()) {\n    uni.showToast({\n      title: 'ËØ∑ËæìÂÖ•ÊèèËø∞',\n      icon: 'none'\n    })\n    return\n  }\n\n  uni.showLoading({ title: 'ÂèëÂ∏É‰∏≠...' })\n\n  try {\n    const db = uniCloud.database()\n\n    await db.collection('requests').add({\n      type: 'buddy',\n      title: formData.value.title,\n      description: formData.value.description,\n      tags: formData.value.tags,\n      maxParticipants: formData.value.maxParticipants || null,\n      creator: userStore.user?._id || 'user_' + Date.now(),\n      creatorName: userStore.user?.nickname || 'Ê†°Âõ≠Áî®Êà∑',\n      createTime: Date.now(),\n      status: 'open'\n    })\n\n    uni.hideLoading()\n    uni.showToast({\n      title: 'ÂèëÂ∏ÉÊàêÂäüÔºÅ',\n      icon: 'success'\n    })\n\n    setTimeout(() => {\n      uni.navigateBack()\n    }, 1500)\n  } catch (e) {\n    uni.hideLoading()\n    uni.__f__('error','at pages/buddy/create.vue:247','ÂèëÂ∏ÉÂ§±Ë¥•:', e)\n\n    // ÈôçÁ∫ßÂ§ÑÁêÜÔºö‰ΩøÁî®Êú¨Âú∞Â≠òÂÇ®Ê®°Êãü\n    const mockRequest = {\n      _id: 'req_' + Date.now(),\n      title: formData.value.title,\n      description: formData.value.description,\n      tags: formData.value.tags,\n      maxParticipants: formData.value.maxParticipants || null,\n      creator: userStore.user?._id || 'user_' + Date.now(),\n      creatorName: userStore.user?.nickname || 'Ê†°Âõ≠Áî®Êà∑',\n      createTime: Date.now(),\n      status: 'open'\n    }\n\n    // ‰øùÂ≠òÂà∞Êú¨Âú∞\n    const requests = uni.getStorageSync('mock_requests') || []\n    requests.unshift(mockRequest)\n    uni.setStorageSync('mock_requests', requests)\n\n    uni.showToast({\n      title: 'ÂèëÂ∏ÉÊàêÂäüÔºàÊú¨Âú∞Ôºâ',\n      icon: 'success'\n    })\n\n    setTimeout(() => {\n      uni.navigateBack()\n    }, 1500)\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n// ÈáéÂÖΩÊ¥æÈÖçËâ≤ÊñπÊ°à\n$black: #000000;\n$white: #ffffff;\n$red: #FF6B6B;\n$teal: #4ECDC4;\n$yellow: #FFE66D;\n\n.page-container {\n  min-height: 100vh;\n  padding: 24rpx;\n  padding-bottom: 48rpx;\n  background: linear-gradient(180deg, #FFE6F0 0%, #ffffff 50%, #E6F9FF 100%);\n  position: relative;\n}\n\n// ËÉåÊôØÊ∂ÇÈ∏¶\n.page-doodle-1 {\n  position: fixed;\n  top: 100rpx;\n  right: 30rpx;\n  font-size: 40rpx;\n  color: $teal;\n  opacity: 0.3;\n  animation: spin 10s linear infinite;\n  z-index: 0;\n}\n\n// ËøîÂõûÂØºËà™\n.nav-back {\n  display: flex;\n  align-items: center;\n  margin-bottom: 24rpx;\n  padding: 12rpx 0;\n\n  .back-icon {\n    font-size: 36rpx;\n    font-weight: 900;\n    margin-right: 8rpx;\n  }\n\n  .back-text {\n    font-size: 26rpx;\n    font-weight: 700;\n  }\n}\n\n// Ê†áÈ¢òÂç°Áâá\n.header-card {\n  text-align: center;\n  padding: 32rpx 24rpx !important;\n  margin-bottom: 24rpx !important;\n\n  .header-title {\n    display: block;\n    font-size: 40rpx;\n    font-weight: 900;\n    color: $black;\n    margin-bottom: 8rpx;\n  }\n\n  .header-subtitle {\n    display: block;\n    font-size: 24rpx;\n    color: #666;\n  }\n}\n\n// Ë°®ÂçïÂç°Áâá\n.form-card {\n  padding: 32rpx 24rpx !important;\n}\n\n.form-group {\n  margin-bottom: 32rpx;\n\n  .form-label {\n    display: flex;\n    align-items: center;\n    gap: 8rpx;\n    margin-bottom: 12rpx;\n    font-size: 26rpx;\n    font-weight: 900;\n\n    text:first-child {\n      font-size: 28rpx;\n    }\n\n    .required {\n      color: $red;\n    }\n\n    .optional {\n      font-size: 22rpx;\n      color: #999;\n      font-weight: 400;\n    }\n  }\n}\n\n// Ê†áÁ≠æÁΩëÊ†º\n.tag-grid {\n  display: grid;\n  grid-template-columns: repeat(5, 1fr);\n  gap: 12rpx;\n}\n\n.tag-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 6rpx;\n  padding: 16rpx 8rpx;\n  border: 3rpx solid $black;\n  background: $white;\n  box-shadow: 3rpx 3rpx 0 $black;\n  transition: all 0.2s ease;\n\n  text:first-child {\n    font-size: 28rpx;\n  }\n\n  text:last-child {\n    font-size: 20rpx;\n    font-weight: 700;\n  }\n\n  &.active {\n    background: $teal;\n    transform: translate(-2rpx, -2rpx);\n    box-shadow: 5rpx 5rpx 0 $black;\n  }\n\n  &:active {\n    transform: translate(2rpx, 2rpx);\n    box-shadow: 1rpx 1rpx 0 $black;\n  }\n}\n\n// ÊñáÊú¨Âüü\n.textarea-wrapper {\n  position: relative;\n\n  .form-textarea {\n    width: 100%;\n    min-height: 200rpx;\n    padding: 20rpx;\n    border: 4rpx solid $black;\n    background: $white;\n    font-size: 28rpx;\n    line-height: 1.6;\n    box-shadow: 4rpx 4rpx 0 $black;\n\n    clip-path: polygon(\n      1% 0%, 98% 1%, 99% 98%, 1% 100%\n    );\n  }\n\n  .char-count {\n    position: absolute;\n    bottom: 16rpx;\n    right: 16rpx;\n    font-size: 22rpx;\n    color: #999;\n  }\n}\n\n// ‰∫∫Êï∞ÈÄâÊã©\n.participant-selector {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 12rpx;\n}\n\n.participant-item {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 100rpx;\n  padding: 14rpx 20rpx;\n  border: 3rpx solid $black;\n  background: $white;\n  box-shadow: 3rpx 3rpx 0 $black;\n  font-size: 24rpx;\n  font-weight: 700;\n  transition: all 0.2s ease;\n\n  &.active {\n    background: $yellow;\n    transform: translate(-2rpx, -2rpx);\n    box-shadow: 5rpx 5rpx 0 $black;\n  }\n\n  &:active {\n    transform: translate(2rpx, 2rpx);\n    box-shadow: 1rpx 1rpx 0 $black;\n  }\n}\n\n.submit-btn {\n  width: 100%;\n  margin-top: 24rpx;\n}\n\n// ÊèêÁ§∫\n.tips {\n  text-align: center;\n  padding: 24rpx;\n\n  .tips-text {\n    font-size: 24rpx;\n    color: #999;\n  }\n}\n\n// Âä®Áîª\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n</style>\n","import MiniProgramPage from 'E:/codeplace/test/pages/buddy/create.vue'\nwx.createPage(MiniProgramPage)"],"names":["BrutalistCard","BrutalistButton","BrutalistInput","userStore","useUserStore","formData","ref","title","description","tags","maxParticipants","buddyTags","getTagEmoji","tag","selectParticipants","num","value","goBack","uni","index","navigateBack","async","submitRequest","isLoggedIn","trim","length","showLoading","db","uniCloud","database","collection","add","type","creator","_a","user","_id","Date","now","creatorName","_b","nickname","createTime","status","hideLoading","showToast","icon","setTimeout","e","__f__","mockRequest","_c","_d","requests","getStorageSync","unshift","setStorageSync","indexOf","push","splice","wx","createPage","MiniProgramPage"],"mappings":"yGA4HA,MAAAA,EAA0B,IAAA,8CAC1BC,EAA4B,IAAA,gDAC5BC,EAA2B,IAAA,6FASrB,MAAAC,EAAYC,EAAAA,eACZC,EAAWC,EAAAA,IAAc,CAC7BC,MAAO,GACPC,YAAa,GACbC,KAAM,GACNC,gBAAiB,IAGbC,EAAY,CAChB,KAAM,KAAM,KAAM,MAAO,MACzB,KAAM,KAAM,MAAO,KAAM,MAG3B,SAASC,EAAYC,GAaZ,MAZkC,CACvC,KAAM,KACN,KAAM,KACN,KAAM,KACN,MAAO,KACP,MAAO,KACP,KAAM,KACN,KAAM,IACN,MAAO,KACP,KAAM,KACN,KAAM,MAEQA,IAAQ,KAC1B,CAWA,SAASC,EAAmBC,GAC1BV,EAASW,MAAMN,gBAAkBK,CACnC,CAEA,SAASE,IACPC,EAAAC,MAAIC,cACN,CAEAC,eAAeC,gBAET,GAACnB,EAAUoB,WASf,GAAKlB,EAASW,MAAMT,MAAMiB,OAS1B,GAAmC,IAA/BnB,EAASW,MAAMP,KAAKgB,OASxB,GAAKpB,EAASW,MAAMR,YAAYgB,OAAhC,CAQAN,EAAAA,MAAIQ,YAAY,CAAEnB,MAAO,WAErB,IACI,MAAAoB,EAAKC,KAASC,iBAEdF,EAAGG,WAAW,YAAYC,IAAI,CAClCC,KAAM,QACNzB,MAAOF,EAASW,MAAMT,MACtBC,YAAaH,EAASW,MAAMR,YAC5BC,KAAMJ,EAASW,MAAMP,KACrBC,gBAAiBL,EAASW,MAAMN,iBAAmB,KACnDuB,SAAS,OAAAC,EAAU/B,EAAAgC,eAAMC,MAAO,QAAUC,KAAKC,MAC/CC,aAAa,OAAAC,EAAArC,EAAUgC,WAAV,EAAAK,EAAgBC,WAAY,OACzCC,WAAYL,KAAKC,MACjBK,OAAQ,SAGVzB,EAAAC,MAAIyB,cACJ1B,EAAAA,MAAI2B,UAAU,CACZtC,MAAO,QACPuC,KAAM,YAGRC,YAAW,KACT7B,EAAAC,MAAIC,cAAa,GAChB,KA+BL,OA9BS4B,GACP9B,EAAAC,MAAIyB,cACJ1B,EAAAC,MAAI8B,MAAM,QAAQ,gCAAgC,QAASD,GAG3D,MAAME,EAAc,CAClBd,IAAK,OAASC,KAAKC,MACnB/B,MAAOF,EAASW,MAAMT,MACtBC,YAAaH,EAASW,MAAMR,YAC5BC,KAAMJ,EAASW,MAAMP,KACrBC,gBAAiBL,EAASW,MAAMN,iBAAmB,KACnDuB,SAAS,OAAAkB,EAAUhD,EAAAgC,eAAMC,MAAO,QAAUC,KAAKC,MAC/CC,aAAa,OAAAa,EAAAjD,EAAUgC,WAAV,EAAAiB,EAAgBX,WAAY,OACzCC,WAAYL,KAAKC,MACjBK,OAAQ,QAIJU,EAAWnC,EAAAC,MAAImC,eAAe,kBAAoB,GACxDD,EAASE,QAAQL,GACbhC,EAAAA,MAAAsC,eAAe,gBAAiBH,GAEpCnC,EAAAA,MAAI2B,UAAU,CACZtC,MAAO,WACPuC,KAAM,YAGRC,YAAW,KACT7B,EAAAC,MAAIC,cAAa,GAChB,KACL,CA1DA,MALEF,EAAAA,MAAI2B,UAAU,CACZtC,MAAO,QACPuC,KAAM,cAXR5B,EAAAA,MAAI2B,UAAU,CACZtC,MAAO,YACPuC,KAAM,cAXR5B,EAAAA,MAAI2B,UAAU,CACZtC,MAAO,QACPuC,KAAM,cAXR5B,EAAAA,MAAI2B,UAAU,CACZtC,MAAO,OACPuC,KAAM,QAyFZ,6QA/GA,SAAmBjC,GACjB,MAAMM,EAAQd,EAASW,MAAMP,KAAKgD,QAAQ5C,IACxB,IAAdM,EACOd,EAAAW,MAAMP,KAAKiD,KAAK7C,GAEzBR,EAASW,MAAMP,KAAKkD,OAAOxC,EAAO,EAEtC,8XC1KAyC,GAAGC,WAAWC"}