{"version":3,"file":"index.js","sources":["pages/buddy/index.vue","../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYnVkZHkvaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view class=\"page-container\">\n    <!-- È°µÈù¢ËÉåÊôØË£ÖÈ•∞ -->\n    <view class=\"page-doodle-1\">‚ú¶</view>\n    <view class=\"page-doodle-2\">‚óâ</view>\n\n    <!-- È°µÈù¢Ê†áÈ¢òÂç°Áâá -->\n    <brutalist-card class=\"page-header\" taped accent>\n      <text class=\"page-title\">ÊâæÊê≠Â≠ê</text>\n      <text class=\"page-subtitle\">ÂèëÁé∞ÊúâË∂£ÁöÑÊ†°Âõ≠‰ºô‰º¥</text>\n    </brutalist-card>\n\n    <!-- È°∂ÈÉ®Êìç‰ΩúÊ†è -->\n    <view class=\"header-actions\">\n      <brutalist-button class=\"create-btn\" accent taped arrow @click=\"navigateToCreate\">\n        + ÂèëÂ∏ÉÈúÄÊ±Ç\n      </brutalist-button>\n    </view>\n\n    <!-- Á≠õÈÄâÂå∫Âüü -->\n    <brutalist-card class=\"filter-section\" dashed>\n      <view class=\"filter-header\">\n        <text class=\"filter-icon\">üè∑Ô∏è</text>\n        <text class=\"section-title\">Á≠õÈÄâÊ†áÁ≠æ</text>\n      </view>\n      <view class=\"tag-filter\">\n        <view\n          v-for=\"tag in allTags\"\n          :key=\"tag\"\n          class=\"filter-tag\"\n          :class=\"{ 'active': selectedTags.includes(tag) }\"\n          @click=\"toggleTag(tag)\"\n        >\n          <text class=\"tag-emoji\">{{ getTagEmoji(tag) }}</text>\n          <text class=\"tag-label\">{{ tag }}</text>\n        </view>\n      </view>\n    </brutalist-card>\n\n    <!-- ËØ∑Ê±ÇÂàóË°® -->\n    <view class=\"request-list\">\n      <view\n        v-for=\"request in filteredRequests\"\n        :key=\"request._id\"\n        class=\"request-card-wrapper\"\n        @click=\"viewDetail(request)\"\n      >\n        <brutalist-card class=\"request-card\">\n          <view class=\"request-header\">\n            <text class=\"request-title\">{{ request.title }}</text>\n            <view class=\"request-status\" :class=\"'status-' + request.status\">\n              <text>{{ getStatusIcon(request.status) }}</text>\n              <text>{{ getStatusText(request.status) }}</text>\n            </view>\n          </view>\n\n          <text class=\"request-desc\">{{ request.description }}</text>\n\n          <view class=\"request-tags\">\n            <view\n              v-for=\"tag in request.tags\"\n              :key=\"tag\"\n              class=\"tag-badge\"\n            >\n              <text>{{ getTagEmoji(tag) }}</text>\n              <text>{{ tag }}</text>\n            </view>\n          </view>\n\n          <view class=\"request-footer\">\n            <view class=\"request-time\">\n              <text>‚è∞</text>\n              <text>{{ formatTime(request.createTime) }}</text>\n            </view>\n            <view class=\"participants\">\n              <text>üë•</text>\n              <text>{{ request.maxParticipants || '‰∏çÈôê' }}‰∫∫</text>\n            </view>\n          </view>\n        </brutalist-card>\n      </view>\n    </view>\n\n    <!-- Á©∫Áä∂ÊÄÅ -->\n    <view v-if=\"filteredRequests.length === 0\" class=\"empty-state\">\n      <brutalist-card class=\"empty-card\" dashed>\n        <text class=\"empty-icon\">üîç</text>\n        <text class=\"empty-text\">ÊöÇÊó†Áõ∏ÂÖ≥ÈúÄÊ±Ç</text>\n        <text class=\"empty-hint\">Êç¢‰∏™Ê†áÁ≠æËØïËØïÂêßÔºÅ</text>\n      </brutalist-card>\n    </view>\n\n    <!-- Â∫ïÈÉ®ÂØºËà™Ê†è -->\n    <TabBar />\n  </view>\n</template>\n\n<script setup lang=\"uts\">\nimport { ref, computed, onMounted } from 'vue'\nimport { onPullDownRefresh, onShow } from '@dcloudio/uni-app'\nimport { useUserStore } from '@/stores/user'\nimport BrutalistCard from '@/components/brutalist/BrutalistCard.vue'\nimport BrutalistButton from '@/components/brutalist/BrutalistButton.vue'\nimport TabBar from '@/components/brutalist/TabBar.vue'\n\n// ÂÆö‰πâËØ∑Ê±ÇÊé•Âè£\ninterface Request {\n  _id: string\n  title: string\n  description: string\n  tags: string[]\n  status: string\n  createTime: number\n  maxParticipants?: number\n  creator: string\n}\n\nconst userStore = useUserStore()\n\nconst requests = ref<Request[]>([])\nconst selectedTags = ref<string[]>([])\n\n// ÂèØÈÄâÊ†áÁ≠æÔºàÂ∏¶emojiÊò†Â∞ÑÔºâ\nconst allTags = [\n  'Â≠¶‰π†', 'ËøêÂä®', 'ÊóÖÊ∏∏', 'È•≠Êê≠Â≠ê', 'Âõæ‰π¶È¶Ü',\n  'ÁØÆÁêÉ', 'Ë∂≥ÁêÉ', 'ÁæΩÊØõÁêÉ', 'Ëá™‰π†', 'ËÄÉËØï'\n]\n\n// Ëé∑ÂèñÊ†áÁ≠æemoji\nfunction getTagEmoji(tag: string): string {\n  const emojiMap: Record<string, string> = {\n    'Â≠¶‰π†': 'üìö',\n    'ËøêÂä®': 'üèÉ',\n    'ÊóÖÊ∏∏': '‚úàÔ∏è',\n    'È•≠Êê≠Â≠ê': 'üçú',\n    'Âõæ‰π¶È¶Ü': 'üìñ',\n    'ÁØÆÁêÉ': 'üèÄ',\n    'Ë∂≥ÁêÉ': '‚öΩ',\n    'ÁæΩÊØõÁêÉ': 'üè∏',\n    'Ëá™‰π†': '‚úçÔ∏è',\n    'ËÄÉËØï': 'üìù'\n  }\n  return emojiMap[tag] || 'üè∑Ô∏è'\n}\n\n// Á≠õÈÄâÂêéÁöÑËØ∑Ê±Ç\nconst filteredRequests = computed(() => {\n  if (selectedTags.value.length === 0) {\n    return requests.value\n  }\n\n  return requests.value.filter(request => {\n    return selectedTags.value.some(tag => request.tags.includes(tag))\n  })\n})\n\n// ÂàáÊç¢Ê†áÁ≠æÈÄâÊã©\nfunction toggleTag(tag: string) {\n  const index = selectedTags.value.indexOf(tag)\n  if (index === -1) {\n    selectedTags.value.push(tag)\n  } else {\n    selectedTags.value.splice(index, 1)\n  }\n}\n\n// Ëé∑ÂèñÁä∂ÊÄÅÊñáÊú¨\nfunction getStatusText(status: string): string {\n  const statusMap: Record<string, string> = {\n    'open': 'ÊãõÂãü‰∏≠',\n    'filled': 'Â∑≤Êª°Âëò',\n    'completed': 'Â∑≤ÂÆåÊàê'\n  }\n  return statusMap[status] || status\n}\n\n// Ëé∑ÂèñÁä∂ÊÄÅÂõæÊ†á\nfunction getStatusIcon(status: string): string {\n  const iconMap: Record<string, string> = {\n    'open': 'üî•',\n    'filled': '‚úÖ',\n    'completed': 'üéâ'\n  }\n  return iconMap[status] || 'üìå'\n}\n\n// Ê†ºÂºèÂåñÊó∂Èó¥\nfunction formatTime(timestamp: number): string {\n  const date = new Date(timestamp)\n  const now = new Date()\n  const diff = now.getTime() - date.getTime()\n\n  if (diff < 60000) {\n    return 'ÂàöÂàö'\n  } else if (diff < 3600000) {\n    return Math.floor(diff / 60000) + 'ÂàÜÈíüÂâç'\n  } else if (diff < 86400000) {\n    return Math.floor(diff / 3600000) + 'Â∞èÊó∂Ââç'\n  } else {\n    return Math.floor(diff / 86400000) + 'Â§©Ââç'\n  }\n}\n\n// ÂØºËà™Âà∞ÂàõÂª∫È°µÈù¢\nfunction navigateToCreate() {\n  if (!userStore.isLoggedIn) {\n    uni.showToast({\n      title: 'ËØ∑ÂÖàÁôªÂΩï',\n      icon: 'none'\n    })\n    return\n  }\n\n  uni.navigateTo({\n    url: '/pages/buddy/create'\n  })\n}\n\n// Êü•ÁúãËØ¶ÊÉÖ\nfunction viewDetail(request: Request) {\n  uni.navigateTo({\n    url: `/pages/buddy/detail?id=${request._id}`\n  })\n}\n\n// Âä†ËΩΩÊï∞ÊçÆ\nasync function loadRequests() {\n  try {\n    const db = uniCloud.database()\n    const res = await db.collection('requests')\n      .where({\n        type: 'buddy'\n      })\n      .orderBy('createTime desc', 'desc')\n      .get()\n\n    const data = res.data as Request[]\n    requests.value = data.map(item => ({\n      ...item,\n      createTime: item.createTime || Date.now()\n    }))\n  } catch (e) {\n    uni.__f__('error','at pages/buddy/index.vue:243','Âä†ËΩΩÂ§±Ë¥•:', e)\n    const localData = uni.getStorageSync('mock_requests') || []\n    requests.value = localData.map((item: any) => ({\n      ...item,\n      createTime: item.createTime || Date.now()\n    }))\n\n    if (requests.value.length === 0) {\n      requests.value = [\n        {\n          _id: '1',\n          title: 'Âõæ‰π¶È¶ÜÁ∫¶Ëá™‰π†',\n          description: 'ÊòéÂ§©‰∏ãÂçà2ÁÇπÔºåÂõæ‰π¶È¶Ü‰∏âÊ•ºËá™‰π†Âå∫ÔºåÊúâÊ≤°Êúâ‰∏ÄËµ∑Â§ç‰π†È´òÊï∞ÁöÑÂêåÂ≠¶Ôºü',\n          tags: ['Â≠¶‰π†', 'Âõæ‰π¶È¶Ü', 'Ëá™‰π†'],\n          status: 'open',\n          createTime: Date.now() - 3600000,\n          maxParticipants: 4,\n          creator: 'user1'\n        },\n        {\n          _id: '2',\n          title: 'ÁØÆÁêÉ3v3Áº∫‰∫∫',\n          description: '‰ªäÊôö6ÁÇπ‰ΩìËÇ≤È¶ÜÔºåËøòÂ∑Æ‰∏Ä‰∏™‰∫∫Ôºå‰ºöÊâìÁöÑÊù•ÔºÅ',\n          tags: ['ËøêÂä®', 'ÁØÆÁêÉ'],\n          status: 'open',\n          createTime: Date.now() - 7200000,\n          maxParticipants: 6,\n          creator: 'user2'\n        }\n      ] as Request[]\n    }\n  }\n}\n\nonMounted(() => {\n  loadRequests()\n})\n\n// È°µÈù¢ÊòæÁ§∫Êó∂Âà∑Êñ∞ÂàóË°®Ôºà‰ªéÂàõÂª∫È°µÈù¢ËøîÂõûÊó∂Ëß¶ÂèëÔºâ\nonShow(() => {\n  loadRequests()\n})\n\n// ‰∏ãÊãâÂà∑Êñ∞\nonPullDownRefresh(async () => {\n  await loadRequests()\n  // ÂÅúÊ≠¢‰∏ãÊãâÂà∑Êñ∞Âä®Áîª\n  uni.stopPullDownRefresh()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n// ÈáéÂÖΩÊ¥æÈÖçËâ≤ÊñπÊ°à\n$black: #000000;\n$white: #ffffff;\n$red: #FF6B6B;\n$teal: #4ECDC4;\n$yellow: #FFE66D;\n\n.page-container {\n  min-height: 100vh;\n  padding: 24rpx;\n  padding-bottom: 160rpx;\n  background: linear-gradient(180deg, #FFE6F0 0%, #ffffff 50%, #E6F9FF 100%);\n  position: relative;\n}\n\n// È°µÈù¢ËÉåÊôØÊ∂ÇÈ∏¶\n.page-doodle {\n  &-1 {\n    position: fixed;\n    top: 120rpx;\n    right: 40rpx;\n    font-size: 44rpx;\n    color: $yellow;\n    opacity: 0.35;\n    animation: spin 10s linear infinite;\n    z-index: 0;\n  }\n\n  &-2 {\n    position: fixed;\n    top: 350rpx;\n    left: 30rpx;\n    font-size: 38rpx;\n    color: $red;\n    opacity: 0.3;\n    animation: pulse 2.5s ease-in-out infinite;\n    z-index: 0;\n  }\n}\n\n// È°µÈù¢Ê†áÈ¢òÂç°Áâá\n.page-header {\n  text-align: center;\n  padding: 32rpx 24rpx !important;\n  margin-bottom: 24rpx !important;\n\n  .page-title {\n    display: block;\n    font-size: 48rpx;\n    font-weight: 900;\n    color: $black;\n    margin-bottom: 8rpx;\n    letter-spacing: 2rpx;\n  }\n\n  .page-subtitle {\n    display: block;\n    font-size: 24rpx;\n    color: #666;\n  }\n}\n\n// È°∂ÈÉ®Êìç‰ΩúÊ†è\n.header-actions {\n  margin-bottom: 24rpx;\n\n  .create-btn {\n    width: 100%;\n  }\n}\n\n// Á≠õÈÄâÂå∫Âüü\n.filter-section {\n  margin-bottom: 32rpx !important;\n\n  .filter-header {\n    display: flex;\n    align-items: center;\n    gap: 8rpx;\n    margin-bottom: 16rpx;\n  }\n\n  .filter-icon {\n    font-size: 28rpx;\n  }\n\n  .section-title {\n    font-size: 26rpx;\n    font-weight: 900;\n    color: $black;\n  }\n\n  .tag-filter {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 12rpx;\n  }\n\n  .filter-tag {\n    display: flex;\n    align-items: center;\n    gap: 4rpx;\n    padding: 8rpx 14rpx;\n    border: 3rpx solid $black;\n    background: $white;\n    box-shadow: 3rpx 3rpx 0 $black;\n    transition: all 0.2s ease;\n\n    .tag-emoji {\n      font-size: 20rpx;\n    }\n\n    .tag-label {\n      font-size: 22rpx;\n      font-weight: 700;\n    }\n\n    &.active {\n      background: $teal;\n      transform: translate(-1rpx, -1rpx);\n      box-shadow: 4rpx 4rpx 0 $black;\n    }\n\n    &:active {\n      transform: translate(2rpx, 2rpx);\n      box-shadow: 1rpx 1rpx 0 $black;\n    }\n  }\n}\n\n// ËØ∑Ê±ÇÂàóË°®\n.request-list {\n  .request-card-wrapper {\n    margin-bottom: 24rpx;\n  }\n\n  .request-card {\n    padding: 24rpx !important;\n    margin: 0 !important;\n    cursor: pointer;\n  }\n\n  .request-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 16rpx;\n    gap: 12rpx;\n\n    .request-title {\n      font-size: 32rpx;\n      font-weight: 900;\n      color: $black;\n      flex: 1;\n      line-height: 1.3;\n    }\n\n    .request-status {\n      display: flex;\n      align-items: center;\n      gap: 4rpx;\n      padding: 6rpx 12rpx;\n      border: 2rpx solid $black;\n      background: $white;\n      font-size: 22rpx;\n      font-weight: 700;\n      box-shadow: 2rpx 2rpx 0 $black;\n      white-space: nowrap;\n\n      &.status-open {\n        background: $yellow;\n      }\n\n      &.status-filled {\n        background: #FFE0E0;\n      }\n\n      &.status-completed {\n        background: #E0FFE0;\n      }\n    }\n  }\n\n  .request-desc {\n    display: block;\n    font-size: 26rpx;\n    color: #666;\n    margin-bottom: 16rpx;\n    line-height: 1.5;\n  }\n\n  .request-tags {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 10rpx;\n    margin-bottom: 16rpx;\n  }\n\n  .tag-badge {\n    display: flex;\n    align-items: center;\n    gap: 4rpx;\n    padding: 6rpx 12rpx;\n    border: 2rpx solid $black;\n    background: #F5F5F5;\n    font-size: 22rpx;\n    font-weight: 600;\n\n    text:first-child {\n      font-size: 20rpx;\n    }\n  }\n\n  .request-footer {\n    display: flex;\n    justify-content: space-between;\n    padding-top: 16rpx;\n    border-top: 2rpx dashed #ddd;\n  }\n\n  .request-time,\n  .participants {\n    display: flex;\n    align-items: center;\n    gap: 6rpx;\n    font-size: 22rpx;\n    color: #666;\n    font-weight: 600;\n\n    text:first-child {\n      font-size: 24rpx;\n    }\n  }\n}\n\n// Á©∫Áä∂ÊÄÅ\n.empty-state {\n  padding: 64rpx 0;\n}\n\n.empty-card {\n  text-align: center;\n  padding: 48rpx 32rpx !important;\n\n  .empty-icon {\n    display: block;\n    font-size: 96rpx;\n    margin-bottom: 24rpx;\n  }\n\n  .empty-text {\n    display: block;\n    font-size: 28rpx;\n    font-weight: 700;\n    color: $black;\n    margin-bottom: 12rpx;\n  }\n\n  .empty-hint {\n    display: block;\n    font-size: 24rpx;\n    color: #999;\n  }\n}\n\n// Âä®Áîª\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n@keyframes pulse {\n  0%, 100% { transform: scale(1); }\n  50% { transform: scale(1.15); }\n}\n</style>\n","import MiniProgramPage from 'E:/codeplace/test/pages/buddy/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["BrutalistCard","BrutalistButton","TabBar","userStore","useUserStore","requests","ref","selectedTags","allTags","getTagEmoji","tag","filteredRequests","computed","value","length","filter","request","some","tags","includes","getStatusText","status","open","filled","completed","formatTime","timestamp","date","Date","diff","getTime","Math","floor","navigateToCreate","isLoggedIn","uni","navigateTo","url","showToast","title","icon","async","loadRequests","db","uniCloud","database","data","collection","where","type","orderBy","get","map","item","createTime","now","e","index","__f__","localData","getStorageSync","_id","description","maxParticipants","creator","onMounted","onShow","onPullDownRefresh","stopPullDownRefresh","indexOf","push","splice","wx","createPage","MiniProgramPage"],"mappings":"yGAqGA,MAAAA,EAA0B,IAAA,8CAC1BC,EAA4B,IAAA,gDAC5BC,EAAmB,IAAA,oFAcb,MAAAC,EAAYC,EAAAA,eAEZC,EAAWC,MAAe,IAC1BC,EAAeD,MAAc,IAG7BE,EAAU,CACd,KAAM,KAAM,KAAM,MAAO,MACzB,KAAM,KAAM,MAAO,KAAM,MAI3B,SAASC,EAAYC,GAaZ,MAZkC,CACvC,KAAM,KACN,KAAM,KACN,KAAM,KACN,MAAO,KACP,MAAO,KACP,KAAM,KACN,KAAM,IACN,MAAO,KACP,KAAM,KACN,KAAM,MAEQA,IAAQ,KAC1B,CAGM,MAAAC,EAAmBC,EAAAA,UAAS,IACE,IAA9BL,EAAaM,MAAMC,OACdT,EAASQ,MAGXR,EAASQ,MAAME,QAAkBC,GAC/BT,EAAaM,MAAMI,MAAKP,GAAOM,EAAQE,KAAKC,SAAST,SAehE,SAASU,EAAcC,GAMd,MALmC,CACxCC,KAAQ,MACRC,OAAU,MACVC,UAAa,OAEEH,IAAWA,CAC9B,CAaA,SAASI,EAAWC,GACZ,MAAAC,EAAO,IAAIC,KAAKF,GAEhBG,OADUD,MACCE,UAAYH,EAAKG,UAElC,OAAID,EAAO,IACF,KACEA,EAAO,KACTE,KAAKC,MAAMH,EAAO,KAAS,MACzBA,EAAO,MACTE,KAAKC,MAAMH,EAAO,MAAW,MAE7BE,KAAKC,MAAMH,EAAO,OAAY,IAEzC,CAGA,SAASI,IACF9B,EAAU+B,WAQfC,EAAAA,MAAIC,WAAW,CACbC,IAAK,wBARLF,EAAAA,MAAIG,UAAU,CACZC,MAAO,OACPC,KAAM,QAQZ,CAUAC,eAAeC,IACT,IACI,MAAAC,EAAKC,KAASC,WAQdC,SAPYH,EAAGI,WAAW,YAC7BC,MAAM,CACLC,KAAM,UAEPC,QAAQ,kBAAmB,QAC3BC,OAEcL,KACRzC,EAAAQ,MAAQiC,EAAKM,KAAaC,IAAA,IAC9BA,EACHC,WAAYD,EAAKC,YAAc1B,KAAK2B,SAkCxC,OAhCSC,GACPrB,EAAAsB,MAAIC,MAAM,QAAQ,+BAA+B,QAASF,GAC1D,MAAMG,EAAYxB,EAAAsB,MAAIG,eAAe,kBAAoB,GACzDvD,EAASQ,MAAQ8C,EAAUP,KAAKC,IAAe,IAC1CA,EACHC,WAAYD,EAAKC,YAAc1B,KAAK2B,UAGR,IAA1BlD,EAASQ,MAAMC,SACjBT,EAASQ,MAAQ,CACf,CACEgD,IAAK,IACLtB,MAAO,SACPuB,YAAa,gCACb5C,KAAM,CAAC,KAAM,MAAO,MACpBG,OAAQ,OACRiC,WAAY1B,KAAK2B,MAAQ,KACzBQ,gBAAiB,EACjBC,QAAS,SAEX,CACEH,IAAK,IACLtB,MAAO,UACPuB,YAAa,sBACb5C,KAAM,CAAC,KAAM,MACbG,OAAQ,OACRiC,WAAY1B,KAAK2B,MAAQ,KACzBQ,gBAAiB,EACjBC,QAAS,UAIjB,CACF,QAEAC,EAAAA,WAAU,YAKVC,EAAAA,QAAO,YAKPC,EAAAA,mBAAkB1B,gBACVC,IAENP,EAAAsB,MAAIW,qBAAoB,4KApI1B,SAAmB1D,GACjB,MAAM+C,EAAQlD,EAAaM,MAAMwD,QAAQ3D,IACvB,IAAd+C,EACWlD,EAAAM,MAAMyD,KAAK5D,GAEXH,EAAAM,MAAM0D,OAAOd,EAAO,EAErC,sFAauBpC,WACmB,CACtCC,KAAQ,KACRC,OAAU,IACVC,UAAa,MAEAH,IAAW,yNAoC5B,SAAoBL,GAClBmB,EAAAA,MAAIC,WAAW,CACbC,IAAK,0BAA0BrB,EAAQ6C,OAE3C,cA9CA,IAAuBxC,+HChLvBmD,GAAGC,WAAWC"}