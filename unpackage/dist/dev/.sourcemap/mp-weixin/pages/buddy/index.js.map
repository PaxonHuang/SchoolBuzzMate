{"version":3,"file":"index.js","sources":["pages/buddy/index.vue","../../HBuilderX.4.87.2025121004/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYnVkZHkvaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view class=\"page-container\">\n    <!-- é¡µé¢èƒŒæ™¯è£…é¥° -->\n    <view class=\"page-doodle-1\">âœ¦</view>\n    <view class=\"page-doodle-2\">â—‰</view>\n\n    <!-- é¡µé¢æ ‡é¢˜å¡ç‰‡ -->\n    <brutalist-card class=\"page-header\" taped accent>\n      <text class=\"page-title\">æ‰¾æ­å­</text>\n      <text class=\"page-subtitle\">å‘ç°æœ‰è¶£çš„æ ¡å›­ä¼™ä¼´</text>\n    </brutalist-card>\n\n    <!-- é¡¶éƒ¨æ“ä½œæ  -->\n    <view class=\"header-actions\">\n      <brutalist-button class=\"create-btn\" accent taped arrow @click=\"navigateToCreate\">\n        + å‘å¸ƒéœ€æ±‚\n      </brutalist-button>\n    </view>\n\n    <!-- ç­›é€‰åŒºåŸŸ -->\n    <brutalist-card class=\"filter-section\" dashed>\n      <view class=\"filter-header\">\n        <text class=\"filter-icon\">ğŸ·ï¸</text>\n        <text class=\"section-title\">ç­›é€‰æ ‡ç­¾</text>\n      </view>\n      <view class=\"tag-filter\">\n        <view\n          v-for=\"tag in allTags\"\n          :key=\"tag\"\n          class=\"filter-tag\"\n          :class=\"{ 'active': selectedTags.includes(tag) }\"\n          @click=\"toggleTag(tag)\"\n        >\n          <text class=\"tag-emoji\">{{ getTagEmoji(tag) }}</text>\n          <text class=\"tag-label\">{{ tag }}</text>\n        </view>\n      </view>\n    </brutalist-card>\n\n    <!-- è¯·æ±‚åˆ—è¡¨ -->\n    <view class=\"request-list\">\n      <view\n        v-for=\"request in filteredRequests\"\n        :key=\"request._id\"\n        class=\"request-card-wrapper\"\n        @click=\"viewDetail(request)\"\n      >\n        <brutalist-card class=\"request-card\">\n          <view class=\"request-header\">\n            <text class=\"request-title\">{{ request.title }}</text>\n            <view class=\"request-status\" :class=\"'status-' + request.status\">\n              <text>{{ getStatusIcon(request.status) }}</text>\n              <text>{{ getStatusText(request.status) }}</text>\n            </view>\n          </view>\n\n          <text class=\"request-desc\">{{ request.description }}</text>\n\n          <view class=\"request-tags\">\n            <view\n              v-for=\"tag in request.tags\"\n              :key=\"tag\"\n              class=\"tag-badge\"\n            >\n              <text>{{ getTagEmoji(tag) }}</text>\n              <text>{{ tag }}</text>\n            </view>\n          </view>\n\n          <view class=\"request-footer\">\n            <view class=\"request-time\">\n              <text>â°</text>\n              <text>{{ formatTime(request.createTime) }}</text>\n            </view>\n            <view class=\"participants\">\n              <text>ğŸ‘¥</text>\n              <text>{{ request.maxParticipants || 'ä¸é™' }}äºº</text>\n            </view>\n          </view>\n        </brutalist-card>\n      </view>\n    </view>\n\n    <!-- ç©ºçŠ¶æ€ -->\n    <view v-if=\"filteredRequests.length === 0\" class=\"empty-state\">\n      <brutalist-card class=\"empty-card\" dashed>\n        <text class=\"empty-icon\">ğŸ”</text>\n        <text class=\"empty-text\">æš‚æ— ç›¸å…³éœ€æ±‚</text>\n        <text class=\"empty-hint\">æ¢ä¸ªæ ‡ç­¾è¯•è¯•å§ï¼</text>\n      </brutalist-card>\n    </view>\n\n    <!-- åº•éƒ¨å¯¼èˆªæ  -->\n    <TabBar />\n  </view>\n</template>\n\n<script setup lang=\"uts\">\nimport { ref, computed, onMounted } from 'vue'\nimport { useUserStore } from '@/stores/user'\nimport BrutalistCard from '@/components/brutalist/BrutalistCard.vue'\nimport BrutalistButton from '@/components/brutalist/BrutalistButton.vue'\nimport TabBar from '@/components/brutalist/TabBar.vue'\n\n// å®šä¹‰è¯·æ±‚æ¥å£\ninterface Request {\n  _id: string\n  title: string\n  description: string\n  tags: string[]\n  status: string\n  createTime: number\n  maxParticipants?: number\n  creator: string\n}\n\nconst userStore = useUserStore()\n\nconst requests = ref<Request[]>([])\nconst selectedTags = ref<string[]>([])\n\n// å¯é€‰æ ‡ç­¾ï¼ˆå¸¦emojiæ˜ å°„ï¼‰\nconst allTags = [\n  'å­¦ä¹ ', 'è¿åŠ¨', 'æ—…æ¸¸', 'é¥­æ­å­', 'å›¾ä¹¦é¦†',\n  'ç¯®çƒ', 'è¶³çƒ', 'ç¾½æ¯›çƒ', 'è‡ªä¹ ', 'è€ƒè¯•'\n]\n\n// è·å–æ ‡ç­¾emoji\nfunction getTagEmoji(tag: string): string {\n  const emojiMap: Record<string, string> = {\n    'å­¦ä¹ ': 'ğŸ“š',\n    'è¿åŠ¨': 'ğŸƒ',\n    'æ—…æ¸¸': 'âœˆï¸',\n    'é¥­æ­å­': 'ğŸœ',\n    'å›¾ä¹¦é¦†': 'ğŸ“–',\n    'ç¯®çƒ': 'ğŸ€',\n    'è¶³çƒ': 'âš½',\n    'ç¾½æ¯›çƒ': 'ğŸ¸',\n    'è‡ªä¹ ': 'âœï¸',\n    'è€ƒè¯•': 'ğŸ“'\n  }\n  return emojiMap[tag] || 'ğŸ·ï¸'\n}\n\n// ç­›é€‰åçš„è¯·æ±‚\nconst filteredRequests = computed(() => {\n  if (selectedTags.value.length === 0) {\n    return requests.value\n  }\n\n  return requests.value.filter(request => {\n    return selectedTags.value.some(tag => request.tags.includes(tag))\n  })\n})\n\n// åˆ‡æ¢æ ‡ç­¾é€‰æ‹©\nfunction toggleTag(tag: string) {\n  const index = selectedTags.value.indexOf(tag)\n  if (index === -1) {\n    selectedTags.value.push(tag)\n  } else {\n    selectedTags.value.splice(index, 1)\n  }\n}\n\n// è·å–çŠ¶æ€æ–‡æœ¬\nfunction getStatusText(status: string): string {\n  const statusMap: Record<string, string> = {\n    'open': 'æ‹›å‹Ÿä¸­',\n    'filled': 'å·²æ»¡å‘˜',\n    'completed': 'å·²å®Œæˆ'\n  }\n  return statusMap[status] || status\n}\n\n// è·å–çŠ¶æ€å›¾æ ‡\nfunction getStatusIcon(status: string): string {\n  const iconMap: Record<string, string> = {\n    'open': 'ğŸ”¥',\n    'filled': 'âœ…',\n    'completed': 'ğŸ‰'\n  }\n  return iconMap[status] || 'ğŸ“Œ'\n}\n\n// æ ¼å¼åŒ–æ—¶é—´\nfunction formatTime(timestamp: number): string {\n  const date = new Date(timestamp)\n  const now = new Date()\n  const diff = now.getTime() - date.getTime()\n\n  if (diff < 60000) {\n    return 'åˆšåˆš'\n  } else if (diff < 3600000) {\n    return Math.floor(diff / 60000) + 'åˆ†é’Ÿå‰'\n  } else if (diff < 86400000) {\n    return Math.floor(diff / 3600000) + 'å°æ—¶å‰'\n  } else {\n    return Math.floor(diff / 86400000) + 'å¤©å‰'\n  }\n}\n\n// å¯¼èˆªåˆ°åˆ›å»ºé¡µé¢\nfunction navigateToCreate() {\n  if (!userStore.isLoggedIn) {\n    uni.showToast({\n      title: 'è¯·å…ˆç™»å½•',\n      icon: 'none'\n    })\n    return\n  }\n\n  uni.navigateTo({\n    url: '/pages/buddy/create'\n  })\n}\n\n// æŸ¥çœ‹è¯¦æƒ…\nfunction viewDetail(request: Request) {\n  uni.navigateTo({\n    url: `/pages/buddy/detail?id=${request._id}`\n  })\n}\n\n// åŠ è½½æ•°æ®\nasync function loadRequests() {\n  try {\n    const db = uniCloud.database()\n    const res = await db.collection('requests')\n      .where({\n        type: 'buddy',\n        status: 'open'\n      })\n      .orderBy('createTime', 'desc')\n      .get()\n\n    requests.value = res.data as Request[]\n  } catch (e) {\n    uni.__f__('error','at pages/buddy/index.vue:239','åŠ è½½å¤±è´¥:', e)\n    // ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®\n    requests.value = [\n      {\n        _id: '1',\n        title: 'å›¾ä¹¦é¦†çº¦è‡ªä¹ ',\n        description: 'æ˜å¤©ä¸‹åˆ2ç‚¹ï¼Œå›¾ä¹¦é¦†ä¸‰æ¥¼è‡ªä¹ åŒºï¼Œæœ‰æ²¡æœ‰ä¸€èµ·å¤ä¹ é«˜æ•°çš„åŒå­¦ï¼Ÿ',\n        tags: ['å­¦ä¹ ', 'å›¾ä¹¦é¦†', 'è‡ªä¹ '],\n        status: 'open',\n        createTime: Date.now() - 3600000,\n        maxParticipants: 4,\n        creator: 'user1'\n      },\n      {\n        _id: '2',\n        title: 'ç¯®çƒ3v3ç¼ºäºº',\n        description: 'ä»Šæ™š6ç‚¹ä½“è‚²é¦†ï¼Œè¿˜å·®ä¸€ä¸ªäººï¼Œä¼šæ‰“çš„æ¥ï¼',\n        tags: ['è¿åŠ¨', 'ç¯®çƒ'],\n        status: 'open',\n        createTime: Date.now() - 7200000,\n        maxParticipants: 6,\n        creator: 'user2'\n      }\n    ] as Request[]\n  }\n}\n\nonMounted(() => {\n  loadRequests()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n// é‡å…½æ´¾é…è‰²æ–¹æ¡ˆ\n$black: #000000;\n$white: #ffffff;\n$red: #FF6B6B;\n$teal: #4ECDC4;\n$yellow: #FFE66D;\n\n.page-container {\n  min-height: 100vh;\n  padding: 24rpx;\n  padding-bottom: 160rpx;\n  background: linear-gradient(180deg, #FFE6F0 0%, #ffffff 50%, #E6F9FF 100%);\n  position: relative;\n}\n\n// é¡µé¢èƒŒæ™¯æ¶‚é¸¦\n.page-doodle {\n  &-1 {\n    position: fixed;\n    top: 120rpx;\n    right: 40rpx;\n    font-size: 44rpx;\n    color: $yellow;\n    opacity: 0.35;\n    animation: spin 10s linear infinite;\n    z-index: 0;\n  }\n\n  &-2 {\n    position: fixed;\n    top: 350rpx;\n    left: 30rpx;\n    font-size: 38rpx;\n    color: $red;\n    opacity: 0.3;\n    animation: pulse 2.5s ease-in-out infinite;\n    z-index: 0;\n  }\n}\n\n// é¡µé¢æ ‡é¢˜å¡ç‰‡\n.page-header {\n  text-align: center;\n  padding: 32rpx 24rpx !important;\n  margin-bottom: 24rpx !important;\n\n  .page-title {\n    display: block;\n    font-size: 48rpx;\n    font-weight: 900;\n    color: $black;\n    margin-bottom: 8rpx;\n    letter-spacing: 2rpx;\n  }\n\n  .page-subtitle {\n    display: block;\n    font-size: 24rpx;\n    color: #666;\n  }\n}\n\n// é¡¶éƒ¨æ“ä½œæ \n.header-actions {\n  margin-bottom: 24rpx;\n\n  .create-btn {\n    width: 100%;\n  }\n}\n\n// ç­›é€‰åŒºåŸŸ\n.filter-section {\n  margin-bottom: 32rpx !important;\n\n  .filter-header {\n    display: flex;\n    align-items: center;\n    gap: 8rpx;\n    margin-bottom: 16rpx;\n  }\n\n  .filter-icon {\n    font-size: 28rpx;\n  }\n\n  .section-title {\n    font-size: 26rpx;\n    font-weight: 900;\n    color: $black;\n  }\n\n  .tag-filter {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 12rpx;\n  }\n\n  .filter-tag {\n    display: flex;\n    align-items: center;\n    gap: 4rpx;\n    padding: 8rpx 14rpx;\n    border: 3rpx solid $black;\n    background: $white;\n    box-shadow: 3rpx 3rpx 0 $black;\n    transition: all 0.2s ease;\n\n    .tag-emoji {\n      font-size: 20rpx;\n    }\n\n    .tag-label {\n      font-size: 22rpx;\n      font-weight: 700;\n    }\n\n    &.active {\n      background: $teal;\n      transform: translate(-1rpx, -1rpx);\n      box-shadow: 4rpx 4rpx 0 $black;\n    }\n\n    &:active {\n      transform: translate(2rpx, 2rpx);\n      box-shadow: 1rpx 1rpx 0 $black;\n    }\n  }\n}\n\n// è¯·æ±‚åˆ—è¡¨\n.request-list {\n  .request-card-wrapper {\n    margin-bottom: 24rpx;\n  }\n\n  .request-card {\n    padding: 24rpx !important;\n    margin: 0 !important;\n    cursor: pointer;\n  }\n\n  .request-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 16rpx;\n    gap: 12rpx;\n\n    .request-title {\n      font-size: 32rpx;\n      font-weight: 900;\n      color: $black;\n      flex: 1;\n      line-height: 1.3;\n    }\n\n    .request-status {\n      display: flex;\n      align-items: center;\n      gap: 4rpx;\n      padding: 6rpx 12rpx;\n      border: 2rpx solid $black;\n      background: $white;\n      font-size: 22rpx;\n      font-weight: 700;\n      box-shadow: 2rpx 2rpx 0 $black;\n      white-space: nowrap;\n\n      &.status-open {\n        background: $yellow;\n      }\n\n      &.status-filled {\n        background: #FFE0E0;\n      }\n\n      &.status-completed {\n        background: #E0FFE0;\n      }\n    }\n  }\n\n  .request-desc {\n    display: block;\n    font-size: 26rpx;\n    color: #666;\n    margin-bottom: 16rpx;\n    line-height: 1.5;\n  }\n\n  .request-tags {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 10rpx;\n    margin-bottom: 16rpx;\n  }\n\n  .tag-badge {\n    display: flex;\n    align-items: center;\n    gap: 4rpx;\n    padding: 6rpx 12rpx;\n    border: 2rpx solid $black;\n    background: #F5F5F5;\n    font-size: 22rpx;\n    font-weight: 600;\n\n    text:first-child {\n      font-size: 20rpx;\n    }\n  }\n\n  .request-footer {\n    display: flex;\n    justify-content: space-between;\n    padding-top: 16rpx;\n    border-top: 2rpx dashed #ddd;\n  }\n\n  .request-time,\n  .participants {\n    display: flex;\n    align-items: center;\n    gap: 6rpx;\n    font-size: 22rpx;\n    color: #666;\n    font-weight: 600;\n\n    text:first-child {\n      font-size: 24rpx;\n    }\n  }\n}\n\n// ç©ºçŠ¶æ€\n.empty-state {\n  padding: 64rpx 0;\n}\n\n.empty-card {\n  text-align: center;\n  padding: 48rpx 32rpx !important;\n\n  .empty-icon {\n    display: block;\n    font-size: 96rpx;\n    margin-bottom: 24rpx;\n  }\n\n  .empty-text {\n    display: block;\n    font-size: 28rpx;\n    font-weight: 700;\n    color: $black;\n    margin-bottom: 12rpx;\n  }\n\n  .empty-hint {\n    display: block;\n    font-size: 24rpx;\n    color: #999;\n  }\n}\n\n// åŠ¨ç”»\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n@keyframes pulse {\n  0%, 100% { transform: scale(1); }\n  50% { transform: scale(1.15); }\n}\n</style>\n","import MiniProgramPage from 'E:/codeplace/test/pages/buddy/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["BrutalistCard","BrutalistButton","TabBar","userStore","useUserStore","requests","ref","selectedTags","allTags","getTagEmoji","tag","filteredRequests","computed","value","length","filter","request","some","tags","includes","getStatusText","status","open","filled","completed","formatTime","timestamp","date","Date","diff","getTime","Math","floor","navigateToCreate","isLoggedIn","uni","navigateTo","url","showToast","title","icon","onMounted","async","db","uniCloud","database","res","collection","where","type","orderBy","get","data","e","index","__f__","_id","description","createTime","now","maxParticipants","creator","indexOf","push","splice","wx","createPage","MiniProgramPage"],"mappings":"yGAoGA,MAAAA,EAA0B,IAAA,8CAC1BC,EAA4B,IAAA,gDAC5BC,EAAmB,IAAA,oFAcb,MAAAC,EAAYC,EAAAA,eAEZC,EAAWC,MAAe,IAC1BC,EAAeD,MAAc,IAG7BE,EAAU,CACd,KAAM,KAAM,KAAM,MAAO,MACzB,KAAM,KAAM,MAAO,KAAM,MAI3B,SAASC,EAAYC,GAaZ,MAZkC,CACvC,KAAM,KACN,KAAM,KACN,KAAM,KACN,MAAO,KACP,MAAO,KACP,KAAM,KACN,KAAM,IACN,MAAO,KACP,KAAM,KACN,KAAM,MAEQA,IAAQ,KAC1B,CAGM,MAAAC,EAAmBC,EAAAA,UAAS,IACE,IAA9BL,EAAaM,MAAMC,OACdT,EAASQ,MAGXR,EAASQ,MAAME,QAAkBC,GAC/BT,EAAaM,MAAMI,MAAKP,GAAOM,EAAQE,KAAKC,SAAST,SAehE,SAASU,EAAcC,GAMd,MALmC,CACxCC,KAAQ,MACRC,OAAU,MACVC,UAAa,OAEEH,IAAWA,CAC9B,CAaA,SAASI,EAAWC,GACZ,MAAAC,EAAO,IAAIC,KAAKF,GAEhBG,OADUD,MACCE,UAAYH,EAAKG,UAElC,OAAID,EAAO,IACF,KACEA,EAAO,KACTE,KAAKC,MAAMH,EAAO,KAAS,MACzBA,EAAO,MACTE,KAAKC,MAAMH,EAAO,MAAW,MAE7BE,KAAKC,MAAMH,EAAO,OAAY,IAEzC,CAGA,SAASI,IACF9B,EAAU+B,WAQfC,EAAAA,MAAIC,WAAW,CACbC,IAAK,wBARLF,EAAAA,MAAIG,UAAU,CACZC,MAAO,OACPC,KAAM,QAQZ,QAkDAC,EAAAA,WAAU,MAxCVC,iBACM,IACI,MAAAC,EAAKC,KAASC,WACdC,QAAYH,EAAGI,WAAW,YAC7BC,MAAM,CACLC,KAAM,QACN5B,OAAQ,SAET6B,QAAQ,aAAc,QACtBC,MAEH9C,EAASQ,MAAQiC,EAAIM,IA0BvB,OAzBSC,GACPlB,EAAAmB,MAAIC,MAAM,QAAQ,+BAA+B,QAASF,GAE1DhD,EAASQ,MAAQ,CACf,CACE2C,IAAK,IACLjB,MAAO,SACPkB,YAAa,gCACbvC,KAAM,CAAC,KAAM,MAAO,MACpBG,OAAQ,OACRqC,WAAY9B,KAAK+B,MAAQ,KACzBC,gBAAiB,EACjBC,QAAS,SAEX,CACEL,IAAK,IACLjB,MAAO,UACPkB,YAAa,sBACbvC,KAAM,CAAC,KAAM,MACbG,OAAQ,OACRqC,WAAY9B,KAAK+B,MAAQ,KACzBC,gBAAiB,EACjBC,QAAS,SAGf,CACF,+KA3GA,SAAmBnD,GACjB,MAAM4C,EAAQ/C,EAAaM,MAAMiD,QAAQpD,IACvB,IAAd4C,EACW/C,EAAAM,MAAMkD,KAAKrD,GAEXH,EAAAM,MAAMmD,OAAOV,EAAO,EAErC,sFAauBjC,WACmB,CACtCC,KAAQ,KACRC,OAAU,IACVC,UAAa,MAEAH,IAAW,yNAoC5B,SAAoBL,GAClBmB,EAAAA,MAAIC,WAAW,CACbC,IAAK,0BAA0BrB,EAAQwC,OAE3C,cA9CA,IAAuBnC,+HC/KvB4C,GAAGC,WAAWC"}