"use strict";const e=require("../../common/vendor.js"),o={data:()=>({userInfo:{}}),onLoad(){this.getUserInfo()},methods:{async getUserInfo(){try{const o=e.index.getStorageSync("token");if(!o)return void e.index.redirectTo({url:"/pages/login/login"});const n=await e.tr.callFunction({name:"validate-token",data:{token:o}});n.result.success?this.userInfo=n.result.userInfo:(e.index.removeStorageSync("token"),e.index.removeStorageSync("userInfo"),e.index.redirectTo({url:"/pages/login/login"}))}catch(o){console.error("获取用户信息失败:",o),e.index.redirectTo({url:"/pages/login/login"})}},formatDate(e){if(!e)return"";const o=new Date(e);return`${o.getFullYear()}年${o.getMonth()+1}月${o.getDate()}日`},editProfile(){e.index.showToast({title:"功能开发中",icon:"none"})},logout(){e.index.showModal({title:"提示",content:"确定要退出登录吗？",success:o=>{o.confirm&&(e.index.removeStorageSync("token"),e.index.removeStorageSync("userInfo"),e.index.redirectTo({url:"/pages/login/login"}))}})}}};const n=e._export_sfc(o,[["render",function(o,n,r,t,i,s){return e.e({a:i.userInfo.avatar,b:e.t(i.userInfo.nickname),c:i.userInfo.isPhoneVerified},(i.userInfo.isPhoneVerified,{}),{d:i.userInfo.wxOpenId},(i.userInfo.wxOpenId,{}),{e:e.t(i.userInfo.phone?i.userInfo.phone.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):"未绑定"),f:e.t(s.formatDate(i.userInfo.createTime)),g:e.o((...e)=>s.editProfile&&s.editProfile(...e)),h:e.o((...e)=>s.logout&&s.logout(...e))})}]]);wx.createPage(n);
