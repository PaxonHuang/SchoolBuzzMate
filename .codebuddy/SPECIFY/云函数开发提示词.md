SPEC-UNICLOUD-FUNCTION-001
CONTEXT: 实现微信支付订单创建云函数
RULES:
- 严格遵循RULE-002, RULE-004, RULE-005
- 必须进行参数校验和权限验证
- 必须记录操作日志到uniCloud日志服务
- 必须处理微信支付异步通知
TECH STACK: UniCloud Node.js 16+ 微信支付API
REQUIREMENTS:
1. 函数名称: create-order-payment
2. 输入参数: { user_id, order_id, amount, description }
3. 验证用户身份和订单状态
4. 调用微信统一下单API
5. 返回支付签名和订单信息
6. 异常处理：网络错误、参数错误、支付失败
OUTPUT:
- 完整的云函数代码（index.js）
- 云函数配置文件（package.json）
- 参数校验中间件
- 微信支付SDK集成代码
- 安全防护措施（防重放攻击）